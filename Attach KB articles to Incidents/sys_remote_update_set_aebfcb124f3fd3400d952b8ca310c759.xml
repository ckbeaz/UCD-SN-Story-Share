<?xml version="1.0" encoding="UTF-8"?>
<unload unload_date="2018-08-10 23:14:22">
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0051388 Enhancement - Incident Emails Parent</name>
<origin_sys_id/>
<parent display_value=""/>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>7c7fcb124f3fd3400d952b8ca310c74e</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>aebfcb124f3fd3400d952b8ca310c759</sys_id>
<sys_mod_count>1</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifi 4</name>
<origin_sys_id/>
<parent display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</parent>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>c17fcb124f3fd3400d952b8ca310c757</remote_sys_id>
<state>in_hierarchy</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>22bfcb124f3fd3400d952b8ca310c762</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifica</name>
<origin_sys_id/>
<parent display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</parent>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>f87f0b124f3fd3400d952b8ca310c723</remote_sys_id>
<state>in_hierarchy</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>22bfcb124f3fd3400d952b8ca310c765</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0058384 Re-design: Link in "Solved by KB article" email lead to serviceh</name>
<origin_sys_id/>
<parent display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</parent>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>3c7fcb124f3fd3400d952b8ca310c73f</remote_sys_id>
<state>in_hierarchy</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>26bfcb124f3fd3400d952b8ca310c75b</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0058307 Enhancement - Incident Emails: Add knowledge article title/link </name>
<origin_sys_id/>
<parent display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</parent>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>f47fcb124f3fd3400d952b8ca310c74f</remote_sys_id>
<state>in_hierarchy</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>2abfcb124f3fd3400d952b8ca310c762</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0051388 Enhancement - Incident Emails 2</name>
<origin_sys_id/>
<parent display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</parent>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>497fcb124f3fd3400d952b8ca310c758</remote_sys_id>
<state>in_hierarchy</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>a2bfcb124f3fd3400d952b8ca310c75c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0051388 enhancemnet - incident emails 3</name>
<origin_sys_id/>
<parent display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</parent>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>b87fcb124f3fd3400d952b8ca310c73a</remote_sys_id>
<state>in_hierarchy</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>a6bfcb124f3fd3400d952b8ca310c760</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0051388 Enhancement - Incident Emails Parent</name>
<origin_sys_id/>
<parent display_value=""/>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>7c7fcb124f3fd3400d952b8ca310c74e</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>aebfcb124f3fd3400d952b8ca310c759</sys_id>
<sys_mod_count>1</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0058349 Enhancement: KB Article in Incident email also triggers on group</name>
<origin_sys_id/>
<parent display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</parent>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>f47fcb124f3fd3400d952b8ca310c751</remote_sys_id>
<state>in_hierarchy</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>e2bfcb124f3fd3400d952b8ca310c763</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifi 3</name>
<origin_sys_id/>
<parent display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</parent>
<release_date/>
<remote_base_update_set display_value="IET STRY0051388 Enhancement - Incident Emails Parent">aebfcb124f3fd3400d952b8ca310c759</remote_base_update_set>
<remote_parent_id/>
<remote_sys_id>347fcb124f3fd3400d952b8ca310c739</remote_sys_id>
<state>in_hierarchy</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>e6bfcb124f3fd3400d952b8ca310c75a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_script_email_1dd304d9139e5b00d26f5e7f3244b057</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_email"&gt;&lt;sys_script_email action="INSERT_OR_UPDATE"&gt;&lt;name&gt;incident_include_relevant_kb&lt;/name&gt;&lt;new_lines_to_html&gt;true&lt;/new_lines_to_html&gt;&lt;script&gt;&lt;![CDATA[//insert relevant kb articles for this new incident
(function runMailScript(current, template, email, email_action, event) {
    //check if group has attach_kb enabled
    if (!current.assignment_group.u_attach_kb_enable) {
        return;
    }

    var css_str = "&lt;style&gt; table {     font-family: arial, sans-serif;     border-collapse: collapse;     width: 100%; } tr {     border-bottom: 1px solid #ccc; } td, th {     text-align: left;     padding: 8px; } .myButton {     border: 1px solid #337fed;     display: inline-block;     cursor: pointer;     font-family: Arial;     font-size: 12px;     padding: 3px 20px;     text-decoration: none;     /* font-weight:bold; */ } .myButton:hover {     background-color: #1e62d0; }&lt;/style&gt;";
    template.print(css_str);

    //start table
    template.print("&lt;table&gt;");
    if (current.assignment_group.u_attach_kb_method == "Manual") {
        var v1 = current.assignment_group.u_attach_kb_1;
        var v2 = current.assignment_group.u_attach_kb_2;
        var v3 = current.assignment_group.u_attach_kb_3;

        //this func also writes additional articles if &lt; 3 are provided
        writeKb(v1, v2, v3);
    } else {
        //attach 3 kbs that match the search based on short desc
        writeKbMultiple(3);
    }

    template.print("&lt;/table&gt;");
    //end table
})(current, template, email, email_action, event);

// Variables accessible from script:
// current: Current GlideRecord
// template: Handles printing to the email message
// email: EmailOutbound object (null when called from Client Template)
// email_action: GlideRecord for the email notification (null when called from Client Template)
// event: GlideRecord for the event that fired the notification (null when called from Client Template)


function writeKb(v1, v2, v3) {
    //count of how many kb's we need to query
    var count = 0;

    //check if [1, 3] kb is provided
    if (!v1) count++;
    if (!v2) count++;
    if (!v3) count++;

    //dynamically write 3, if mode is manual but 0 kbs are provided
    if (count == 3) {
        writeKbMultiple(count);
    } else {
        writeKbMixed(count, v1, v2, v3);
    }
}


function writeKbMixed(count, v1, v2, v3) {
    var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
    var widget_base = "servicehub?id=incident_close_link&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var query = "";
    query += 'kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e'; // IT - Public
    query += '^roles=public'; //only show public ones so guests can see
    query += '^IR_OR_QUERY=' + current.short_description; //look for inc's short_desc
    query += '^workflow_state=published';

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count); //only need count maximum
    kbArt.addEncodedQuery(query);
    kbArt.query();

    //count    &lt; 3 means {1,2,3} articles were provided
    //rowCount &gt; 0 means {1+} articles were found
    //either case is good to display some kb articles
    if (count &lt; 3 || kbArt.getRowCount &gt; 0) {
        template.print("\n");
        template.print('Meanwhile, please see the following Knowledge Base articles to see if they might assist you with your inquiry:');
        template.print("\n");
    }

    //if kb is provided, write that one
    if (v1) {
        template.print("&lt;tr&gt;");

        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;u&gt;&lt;a href=' + base_url + v1.sys_id + ' target="_blank"&gt;' + v1.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;');

        //button
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + v1.sys_id + "&amp;inc_num=" + current.number;
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

        template.print("&lt;/tr&gt;");
    }
    //else, write it from the query
    else {
        //if query has a kb
        if (kbArt.next()) {
            template.print("&lt;tr&gt;");

            //kb link
            template.print('&lt;td&gt;&lt;b&gt;&lt;u&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;');

            //button
            var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id + "&amp;inc_num=" + current.number;
            template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

            template.print("&lt;/tr&gt;");
        }
        //else query didnt have a kb
        //dont do anything kek
    }

    if (v2) {
        template.print("&lt;tr&gt;");

        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;u&gt;&lt;a href=' + base_url + v2.sys_id + ' target="_blank"&gt;' + v2.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;');

        //button
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + v2.sys_id + "&amp;inc_num=" + current.number;
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

        template.print("&lt;/tr&gt;");
    }
    //else, write it from the query
    else {
        //if query has a kb
        if (kbArt.next()) {
            template.print("&lt;tr&gt;");

            //kb link
            template.print('&lt;td&gt;&lt;b&gt;&lt;u&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;');

            //button
            var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id + "&amp;inc_num=" + current.number;
            template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

            template.print("&lt;/tr&gt;");
        }
        //else query didnt have a kb
        //dont do anything kek
    }

    //if kb is provided, write that one
    if (v3) {
        template.print("&lt;tr&gt;");

        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;u&gt;&lt;a href=' + base_url + v3.sys_id + ' target="_blank"&gt;' + v3.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;');

        //button
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + v3.sys_id + "&amp;inc_num=" + current.number;
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

        template.print("&lt;/tr&gt;");
    }
    //else, write it from the query
    else {
        //if query has a kb
        if (kbArt.next()) {
            template.print("&lt;tr&gt;");

            //kb link
            template.print('&lt;td&gt;&lt;b&gt;&lt;u&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;');

            //button
            var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id + "&amp;inc_num=" + current.number;
            template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

            template.print("&lt;/tr&gt;");
        }
        //else query didnt have a kb
        //dont do anything kek
    }

}


function writeKbMultiple(count) {
    var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
    var widget_base = "servicehub?id=ucd_index&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var query = "";
    query += 'kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e'; // IT - Public
    query += '^roles=public'; //only show public ones so guests can see
    query += '^IR_OR_QUERY=' + current.short_description; //look for inc's short_desc
    query += '^workflow_state=published';

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count); //only need 3 maximum
    kbArt.addEncodedQuery(query);
    kbArt.query();

    if (kbArt.getRowCount &gt; 0) {
        template.print("\n");
        template.print('Meanwhile, please see the following Knowledge Base articles to see if they might assist you with your inquiry:');
        template.print("\n");
    }

    //it's possible we don't get 3 articles back.
    //then just write as many as we get
    while (kbArt.next()) {
        template.print("&lt;tr&gt;");

        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;u&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;');
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id + "&amp;inc_num=" + current.number;

        //button
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

        template.print("&lt;/tr&gt;");
    }
}
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_email&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-24 16:16:20&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_id&gt;&lt;sys_mod_count&gt;87&lt;/sys_mod_count&gt;&lt;sys_name&gt;incident_include_relevant_kb&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_email_1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-eduque&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-07-25 17:50:13&lt;/sys_updated_on&gt;&lt;/sys_script_email&gt;&lt;/record_update&gt;</payload>
<payload_hash>2105329053</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifi 4">22bfcb124f3fd3400d952b8ca310c762</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>e2bfcb124f3fd3400d952b8ca310c762</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>164d297d0500000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table/>
<target_name>incident_include_relevant_kb</target_name>
<type>Email Script</type>
<update_domain>global</update_domain>
<update_guid>ea1c6785cf275340b6a2a30a47e0559e</update_guid>
<update_guid_history>ea1c6785cf275340b6a2a30a47e0559e:2105329053,4eb3504f765f1f009bd1d645d137522c:-2115863112,6776cc87b75f1f00305883cd618e0125:-1066670967,abd3c08f0e1f1f000e0caca71bda6742:449609015,862a7bfe511f1f0097ad8b2d360c4129:1015550801,07c5377ecd1f1f0088fbff70b14855c5:1450677504,f1b3b3ba8e1f1f00aa6cf8a33cb9f300:-2069218255,0ed0b3badb1f1f001b2a5984cd4adbf3:-1467638668,290cef36151f1f00dc1434bc3a8733e4:-1154811557,4a6c0aaa89d7db00f37ff668918ea53d:449609015,b0ce5e0a318353003a8ca836a8f084b9:1542691347,4e0d9ac230835300ff186cec33ce9e2d:707707576,4f679202028353003d63243141e32ad5:-1261772362,af725e8a7b43530023050d0a9ac107ad:-865979662,c9519e0a744353006573425eaa71f127:494305476,7465c642ef43530069e564837c73bec4:1578689896,349a8ab14e4b13009bc9d83e77abf18b:-1565510080,ed8789b1d2871300ede545f7cbfbe1a2:-1667052640,a0d36bf125b6538047958b79d0d26111:-731803741,1af0e37172b65380aadc4432690cfe8a:-82312715,eed06fb13db65380037a13ce53420461:-731803741,1bff9bb1c1b65380cdd741d401d67355:-1121188946,64fd87e1fc3e1380b50b91e01fce4528:-731803741,7a4932212afa1380e449d308e6e2d73c:-1029147077,8df52e2551ba1380305bd1bf7a32d8bb:1891044717,bfe52e253aba13807cbeb73166ddd379:-106479397,49c56e25a9ba1380529ad12d3f53f08a:1596226715,67a5aee141ba1380053fdb5f81f7072a:1752739899,37556225bfba138091abcbbfa2a68913:729397439,f814a6e122ba138010aa3376c28e6ed8:1371620317,5ba32ae1b6ba1380e00166a04942bef7:473462572,b28266a116ba138072046886103a74fa:-626877156,6f8122a1baba1380bce38d66e79e33e9:-102970522,97dc12e9c87a1380f9307ad55a84dbd9:776183103,a245f510083e97405db29c8a58715a57:-774461761,a15fd20602621b405ba2dcde41c81fd7:-718301875,20be56c2ee621b409574d180ced165be:1272403919,18ed1dafd7dad3009c06ba29d96ecf28:889957367,af7d95afacdad300f63cb9be97546207:-1083534923,984d15affcdad300a0b45d82c3ebcd23:-1174782924,97cc996f76dad30045aa497285476d2e:-1927758944,f93b19eb77dad300cb19a6260edc822e:-2140074465,4298156ba4dad3009f77094059d347f7:794175821,8b51952731dad300d1a82f5df68da175:-426053895,4c4f05a3eedad3007ee3610b4c94df5e:794175821,bd6305ebef9ad30085cdeeff6d36f129:-536487651,4ba1cd2bef9ad3001393edc890fb1ea5:2092245381,0b47e827a15ad3008658df05b6deff33:226830873,59e56827955ad3004d0427e3221b4c4b:-746666249,80e5e8276a5ad300319b0f5af3c879e2:1650496228,4165ace3755ad3001926723ec99368f8:282954009,8fb4e0279e5ad30036e81ffa1a1e5258:653214181,c31420e38a5ad30041c31da96c5f9f68:-1735407054,f192ac63505ad3000812b60fefea4cdb:1741323955,ed9198e7391ad300d99133818b271d23:2024030483,e4684f3eaf1693002019808e04d2c6f3:1393366783,08644bbab116930080271ee01e92f1e7:-339299198,afb3c3babf16930070d18ae6e8cc4e7a:1411950891,71a34b3a7f16930054f8924d5b96197c:129615693,00f0433a4316930064abfc8ebb5d9823:-144072004,0dcabe368a169300853ddef7d1db2fe6:1288834507,336a3a360c169300ec1f5a4937195df8:-161266019,f469feb26616930082b811c910811903:-708362339,9f187e72dc169300dfe3c70f986f77bd:-333097782,b6573efebdd2930095289652f56465c8:-864184942,93753efec4d29300b522b1be373b54c2:959388866,a7c47e7e37d2930059ceaa1e21cfe5ef:-554236393,5e9aa6f6f1d29300da8eb275501c6a29:-2058353522,c1496e369bd293000e6c5abeeaa50733:-1095736062,1c20ae7aa956df00bcf89b92e10e0ae5:-643951813,6e6f5e3e4d56df00a0c03e934a1a822f:-527518582,6c9edaba9896df006b5910bc745cfa3c:778447343,26e082b60256df00143fc38799e428ad:-1062469659,eb39b9b2ad56df006f79632251155dc8:2024427394,881f491552529b0033d6c29387d4bf0f:2032238305,0a5e011181529b000fdde17eef3def83:-1075160591,ea18415153529b0064eab1de491bc621:-6890014,bdf7c59d01129b001423e7aaea248aac:-1434059075,5ad5c59d60129b0047432bda3e95bef4:1253601649,bbb37455ac129b00faa8d17c179858cf:-1992214228,7232345545129b00fb65ce7a0a703fa1:496527116,9bbda051c2129b007e1a6d2985d78db5:1781045456,de4ae419f3de5b008b555d6c79a54fe3:-723601656,4203ac1d3ede5b006618d823ab617896:1908294079,5a495895b6de5b0044f5380ff50c7e5f:-1371753776,85f6d8d15dde5b0008c176d65da616d5:45003350,165604d9209e5b00d31ee8dab18f21fa:648340869,aa04c8d9f69e5b00afe4dd51aa150b8e:-667673171</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_widget_a10631fe1316df0093625dcf3244b08c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;client_script&gt;&lt;![CDATA[function() {
  /* widget controller */
  var c = this;
	
	//function to extract fields from url
	function gup( name, url ) {
    if (!url) url = location.href;
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regexS = "[\\?&amp;]"+name+"=([^&amp;#]*)";
    var regex = new RegExp( regexS );
    var results = regex.exec( url );
    return results == null ? null : results[1];
	}
	//gup('q', 'hxxp://example.com/?q=abc')
	//alert(window.location.href)
	//alert(gup("inc", window.location.href))
	
	console.log("inc: " + gup("inc", window.location.href));
	console.log("kb: " + gup("kb", window.location.href));
	
	//onload, send id to server to resolve the inc
	c.data.inc_id = gup("inc", window.location.href)
	if (c.data.inc_id){
		c.server.update().then(function(){
			c.data.inc_id = undefined;
		})
	}
	
	//do something with the given KB too eventually
	c.data.kb = gup("kb", window.location.href);
	
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css/&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;true&lt;/has_preview&gt;&lt;id&gt;incident_close_link&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link/&gt;&lt;name&gt;Incident Close Link&lt;/name&gt;&lt;option_schema/&gt;&lt;public&gt;true&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
	
	//var temp = "27a11ce7131ad300d26f5e7f3244b0ed"; //random inc
	
	//client gave me the inc to remove
	//widget should set 
	//state -&gt; resolved (6)
	//close_code -&gt; resolved by caller "Resolved by Caller"
	//add comment "resolved by caller"
	
	if (input &amp;&amp; input.inc_id){
		var gr = new GlideRecord("incident");
		gr.addQuery("sys_id", input.inc_id);
		//gr.addQuery("sys_id", temp);
		gr.query();
		
		if (gr.next()){
			if (gr.state == 6 &amp;&amp; gr.close_code == "Resolved by Caller"){
				return;
			}
			
			gr.state = 6;
			gr.close_code = "Resolved by Caller";
			gr.comments.setJournalEntry("Resolved by Caller.", "System");

			gr.update();
		}
	}
	

	//test
	/*
	var gr = new GlideRecord("incident");
	gr.addQuery("sys_id", "5440f13613529300d26f5e7f3244b071");
	gr.query()

	if (gr.next()){
		//gs.addInfoMessage(gr.state);
		gr.state = 1;
		gr.update();
	}

	//incident state codes
	//1 new
	//6 resolved
	//7 closed
	*/
	
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-29 16:25:14&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;a10631fe1316df0093625dcf3244b08c&lt;/sys_id&gt;&lt;sys_mod_count&gt;35&lt;/sys_mod_count&gt;&lt;sys_name&gt;Incident Close Link&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_a10631fe1316df0093625dcf3244b08c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-05 21:01:13&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div&gt;
&lt;!-- your widget template --&gt;
  &lt;div&gt;
    Thank you,
  &lt;/div&gt;
  &lt;div&gt;
    Your ticket has been closed.
  &lt;/div&gt;
 
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>1737855977</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifica">22bfcb124f3fd3400d952b8ca310c765</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>2abf83524f3fd3400d952b8ca310c71a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e12436c80000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>Incident Close Link</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>3458368d3a22d700086fb186d69492f2</update_guid>
<update_guid_history>3458368d3a22d700086fb186d69492f2:1737855977,ecb166c54422d7002b5f6e8c3567d06d:244790540,7ccbd12fc6dad30033859879033ebbf6:1613598326,2364852fe49ad3007e011867317a1b12:1781556162,47d309eb809ad30027ce867556a360e1:-1819011998,6292cdabd39ad300fae2a3337118ef51:-1904565963,e34e7ce7049ad300b25f08140080e5f1:-302582566,256cb4a7209ad3004c6ecc7eb8edb3fa:-166846082,7a4cb4a7d29ad3005e11f5d10bd32d54:1628175183,ed3c34a71b9ad30038daaf610dfba863:2054336,54cbbc677c9ad300e6b602d41d9bf635:188141296,2b9bf4a3529ad3009dc063a4c148140b:-1127112208,b21ab427e09ad300ac16843dbeab704e:-304914590,afcbf936d456df000864f05b5dcffa10:1243862241,969bfdb29956df006ea68e1f0da4e73c:-1154578685,f49bb9367d56df00cf28ea3105a7be2d:1405811870,c37b31b21356df00c4702f57c2030a9a:-1108135387,b82bb9b25056df00227bba2c42aef9c1:452376687,fbb871b27256df00499cff2b4025724a:349372834,5ba83d724956df0071365bf85e82f8f8:-1811038098,e15831b2b256df00ecea89e9d362235b:1090736169,444871b20056df00572b7655d0b76343:-1243757800,493839722e56df00b6c99672e9ae7eb4:635086784,af2831b28556df00ad54246593999540:821013785,9d2839726656df00554e8d6a584165ad:-98462806,9418f5327a56df00054614a847133f00:-1045176205,c7e7f9725f56df00f31725fb078d5881:2109700040,5bd7b972df56df00f4acb25d778d7b3e:-993690448,eac7f9720a56df0022051f280ac00d7a:-912124522,4ba7b972de56df006d1925ee7e2d4f37:-1868011490,8b7735329b56df002745196d9300db71:-186816256,0d677dfea716df00affd360a94e608b9:1351271116,fc373d327756df00fa2dfc4040eea6c7:-681331990,3196fd322256df00f44201aa5e4294c7:-1219586856,8f76bd327c56df00bfb915c75507ff64:-2056561234,e50631fe5816df00f282617fcdaf788d:1406429426</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_container_7d0631fe1316df0093625dcf3244b091</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_container"><sp_container action="INSERT_OR_UPDATE"><background_color/><background_image/><background_style>default</background_style><bootstrap_alt>false</bootstrap_alt><class_name/><container_class_name/><name>Incident Close Link - Test Page - Container 1</name><order>1</order><sp_page display_value="incident_close_link">290631fe1316df0093625dcf3244b08f</sp_page><subheader>false</subheader><sys_class_name>sp_container</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-05-29 16:25:14</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>7d0631fe1316df0093625dcf3244b091</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Incident Close Link - Test Page - Container 1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_container_7d0631fe1316df0093625dcf3244b091</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-05-29 16:25:14</sys_updated_on><title/><width>container</width></sp_container></record_update>]]></payload>
<payload_hash>-1720914799</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifica">22bfcb124f3fd3400d952b8ca310c765</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>2ebf83524f3fd3400d952b8ca310c719</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e12436c80000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>Incident Close Link - Test Page - Container 1</target_name>
<type>Container</type>
<update_domain>global</update_domain>
<update_guid>fd0631feaa16df0065b5837eb9fbd992</update_guid>
<update_guid_history>fd0631feaa16df0065b5837eb9fbd992:-1720914799</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_row_b10631fe1316df0093625dcf3244b094</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_row"><sp_row action="INSERT_OR_UPDATE"><class_name/><order>1</order><sp_column/><sp_container display_value="Incident Close Link - Test Page - Container 1">7d0631fe1316df0093625dcf3244b091</sp_container><sys_class_name>sp_row</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-05-29 16:25:14</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>b10631fe1316df0093625dcf3244b094</sys_id><sys_mod_count>0</sys_mod_count><sys_name>1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_row_b10631fe1316df0093625dcf3244b094</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-05-29 16:25:14</sys_updated_on></sp_row></record_update>]]></payload>
<payload_hash>1719442953</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifica">22bfcb124f3fd3400d952b8ca310c765</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>66bf83524f3fd3400d952b8ca310c71a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e12436c80000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>1</target_name>
<type>Row</type>
<update_domain>global</update_domain>
<update_guid>f9063532a656df003361fcaaa78cbb67</update_guid>
<update_guid_history>f9063532a656df003361fcaaa78cbb67:1719442953</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_column_bd0635321356df0093625dcf3244b068</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_column"><sp_column action="INSERT_OR_UPDATE"><class_name/><order>1</order><size>12</size><size_lg/><size_sm/><size_xs/><sp_row display_value="1">b10631fe1316df0093625dcf3244b094</sp_row><sys_class_name>sp_column</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-05-29 16:25:14</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>bd0635321356df0093625dcf3244b068</sys_id><sys_mod_count>0</sys_mod_count><sys_name>1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_column_bd0635321356df0093625dcf3244b068</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-05-29 16:25:14</sys_updated_on></sp_column></record_update>]]></payload>
<payload_hash>-203819308</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifica">22bfcb124f3fd3400d952b8ca310c765</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>6abf83524f3fd3400d952b8ca310c719</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e12436c80000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>1</target_name>
<type>Column</type>
<update_domain>global</update_domain>
<update_guid>fd0635327756df00ff782a382e00ea69</update_guid>
<update_guid_history>fd0635327756df00ff782a382e00ea69:-203819308</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_page_290631fe1316df0093625dcf3244b08f</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_page"><sp_page action="INSERT_OR_UPDATE"><css/><draft>false</draft><id>incident_close_link</id><internal>false</internal><public>false</public><roles/><short_description/><sys_class_name>sp_page</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-05-29 16:25:14</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>290631fe1316df0093625dcf3244b08f</sys_id><sys_mod_count>0</sys_mod_count><sys_name>incident_close_link</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_page_290631fe1316df0093625dcf3244b08f</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-05-29 16:25:14</sys_updated_on><title>Incident Close Link - Test Page</title></sp_page></record_update>]]></payload>
<payload_hash>-905003901</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifica">22bfcb124f3fd3400d952b8ca310c765</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>a2bf83524f3fd3400d952b8ca310c71a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e12436c80000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>incident_close_link</target_name>
<type>Page</type>
<update_domain>global</update_domain>
<update_guid>b90631febc16df00dc6484dab53a9b90</update_guid>
<update_guid_history>b90631febc16df00dc6484dab53a9b90:-905003901</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_script_email_1dd304d9139e5b00d26f5e7f3244b057</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_email"&gt;&lt;sys_script_email action="INSERT_OR_UPDATE"&gt;&lt;name&gt;incident_include_relevant_kb&lt;/name&gt;&lt;new_lines_to_html&gt;true&lt;/new_lines_to_html&gt;&lt;script&gt;&lt;![CDATA[//insert relevant kb articles for this new incident
(function runMailScript(current, template, email, email_action, event) {
    //check if group has attach_kb enabled
    if (!current.assignment_group.u_attach_kb_enable){
        return;
    }

    //attach_kb is enabled for the group, so write the following
    template.print("\n");
    template.print('Meanwhile, please see the following Knowledge Base articles to see if they might assist you with your inquiry:');
    template.print("\n");

    //does group have manual kb attachment tho?
    //attaching the kb articles is different if group has manual settings.
	//start table
	
	//css for table and button
// 	var css_str = "&lt;style&gt;table {    font-family: arial, sans-serif;    border-collapse: collapse;    width: 100%;}tr {border-bottom: 1px solid #ccc;}td, th {    text-align: left;    padding: 8px;}.myButton {	-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;	-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;	box-shadow:inset 0px 1px 0px 0px #97c4fe;	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #3d94f6), color-stop(1, #1e62d0));	background:-moz-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-webkit-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-o-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-ms-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:linear-gradient(to bottom, #3d94f6 5%, #1e62d0 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#3d94f6', endColorstr='#1e62d0',GradientType=0);	background-color:#3d94f6;	-moz-border-radius:6px;	-webkit-border-radius:6px;	border-radius:6px;	border:1px solid #337fed;	display:inline-block;	cursor:pointer;	color:#ffffff;	font-family:Arial;	font-size:15px;	font-weight:bold;	padding:6px 24px;	text-decoration:none;	text-shadow:0px 1px 0px #1570cd;}.myButton:hover {	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #1e62d0), color-stop(1, #3d94f6));	background:-moz-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-webkit-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-o-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-ms-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:linear-gradient(to bottom, #1e62d0 5%, #3d94f6 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#1e62d0', endColorstr='#3d94f6',GradientType=0);	background-color:#1e62d0;}.myButton:active {	position:relative;	top:1px;}&lt;/style&gt;";
	var css_str = "&lt;style&gt;table {    font-family: arial, sans-serif;    border-collapse: collapse;    width: 100%;}tr {border-bottom: 1px solid #ccc;}td, th {    text-align: left;    padding: 8px;}.myButton {		-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;	-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;	background-color:#3d94f6;	-moz-border-radius:6px;	-webkit-border-radius:6px;	border-radius:6px;	border:1px solid #337fed;	display:inline-block;	cursor:pointer;	color:#ffffff;	font-family:Arial;	font-size:12px;	/* font-weight:bold; */	padding:3px 10px;	text-decoration:none;	text-shadow:0px 1px 0px #1570cd;}.myButton:hover {	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #1e62d0), color-stop(1, #3d94f6));	background:-moz-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-webkit-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-o-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-ms-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:linear-gradient(to bottom, #1e62d0 5%, #3d94f6 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#1e62d0', endColorstr='#3d94f6',GradientType=0);	background-color:#1e62d0;}.myButton:active {	position:relative;	top:1px;}&lt;/style&gt;";
	template.print(css_str);
	
	//start table
	template.print("&lt;table&gt;");
    if (current.assignment_group.u_attach_kb_method == "Manual"){
        var v1 = current.assignment_group.u_attach_kb_1;
        var v2 = current.assignment_group.u_attach_kb_2;
        var v3 = current.assignment_group.u_attach_kb_3;
		
		//this func also writes additional articles if &lt; 3 are provided
        writeKb(v1, v2, v3);
    } else {
        //attach 3 kbs that match the search based on short desc
        writeKbMultiple(3);
    }
	template.print("&lt;/table&gt;");
	//end table

	/*
    //write the rest of the msg
    template.print("\n");
    template.print("\n");
    template.print('If the KB articles solved your inquiry, please click the link below to close your ticket.');

    //add link to widget that closes the incident
	
    template.print("\n");
    var widget_with_inc = "url_to_widget/?inc=" + current.sys_id;
    template.print('&lt;a href=' + widget_with_inc  + ' target="_blank"&gt;Click here to close your incident.&lt;/a&gt;');
	*/

})(current, template, email, email_action, event);

// Variables accessible from script:
// current: Current GlideRecord
// template: Handles printing to the email message
// email: EmailOutbound object (null when called from Client Template)
// email_action: GlideRecord for the email notification (null when called from Client Template)
// event: GlideRecord for the event that fired the notification (null when called from Client Template)


function writeKb(v1, v2, v3){
    //count of how many kb's we need to query
	var count = 0;
	
	//check if [1, 3] kb is provided
	if (!v1) count++;
	if (!v2) count++;
	if (!v3) count++;

	//dynamically write 3, if mode is manual but 0 kbs are provided
	if (count == 3) {
		writeKbMultiple(count);
	}
	else {
		writeKbMixed(count, v1, v2, v3);
	}
}


function writeKbMixed(count, v1, v2, v3){
	var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
	var widget_base = "sp?id=inc_resolved_by_caller&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var kbase = '7c2d56f42bd89200e0b209d417da153e'; // IT - Public

	var query = "";
    query += 'kb_knowledge_base=' + kbase;
    query += '^123TEXTQUERY321=' + current.short_description;

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count);
    kbArt.addEncodedQuery(query);
    kbArt.addQuery('kb_knowledge_base', kbase);
    kbArt.addQuery('workflow_state','published');
    kbArt.query();

    //if kb is provided, write that one
	if (v1){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v1.sys_id + ' target="_blank"&gt;' + v1.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	} 
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		} 
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

	//if kb is provided, write that one
	if (v2){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v2.sys_id + ' target="_blank"&gt;' + v2.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	} 
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		} 
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}
	
    //if kb is provided, write that one
	if (v3){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v3.sys_id + ' target="_blank"&gt;' + v3.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	} 
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		} 
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}
	
}


function writeKbMultiple(count) {
    var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
    var widget_base = "sp?id=inc_resolved_by_caller&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var kbase = '7c2d56f42bd89200e0b209d417da153e'; // IT - Public

    var query = "";
    query += 'kb_knowledge_base=' + kbase;
    query += '^123TEXTQUERY321=' + current.short_description;

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count);
    kbArt.addEncodedQuery(query);
    kbArt.addQuery('kb_knowledge_base', kbase);
    kbArt.addQuery('workflow_state', 'published');
    kbArt.query();
    
    //it's possible we don't get 3 articles back.
    //then just write as many as we get
    while (kbArt.next()) {
        //gs.log(kbArt.number + " " + kbArt.short_description);
        template.print("&lt;tr&gt;");
        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		//button
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
        template.print("&lt;/tr&gt;");
    }
}



]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_email&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-24 16:16:20&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_id&gt;&lt;sys_mod_count&gt;50&lt;/sys_mod_count&gt;&lt;sys_name&gt;incident_include_relevant_kb&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_email_1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-05-31 22:35:09&lt;/sys_updated_on&gt;&lt;/sys_script_email&gt;&lt;/record_update&gt;</payload>
<payload_hash>889957367</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifica">22bfcb124f3fd3400d952b8ca310c765</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>aebf83524f3fd3400d952b8ca310c71a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e12436c80000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>incident_include_relevant_kb</target_name>
<type>Email Script</type>
<update_domain>global</update_domain>
<update_guid>18ed1dafd7dad3009c06ba29d96ecf28</update_guid>
<update_guid_history>18ed1dafd7dad3009c06ba29d96ecf28:889957367,af7d95afacdad300f63cb9be97546207:-1083534923,984d15affcdad300a0b45d82c3ebcd23:-1174782924,97cc996f76dad30045aa497285476d2e:-1927758944,f93b19eb77dad300cb19a6260edc822e:-2140074465,4298156ba4dad3009f77094059d347f7:794175821,8b51952731dad300d1a82f5df68da175:-426053895,4c4f05a3eedad3007ee3610b4c94df5e:794175821,bd6305ebef9ad30085cdeeff6d36f129:-536487651,4ba1cd2bef9ad3001393edc890fb1ea5:2092245381,0b47e827a15ad3008658df05b6deff33:226830873,59e56827955ad3004d0427e3221b4c4b:-746666249,80e5e8276a5ad300319b0f5af3c879e2:1650496228,4165ace3755ad3001926723ec99368f8:282954009,8fb4e0279e5ad30036e81ffa1a1e5258:653214181,c31420e38a5ad30041c31da96c5f9f68:-1735407054,f192ac63505ad3000812b60fefea4cdb:1741323955,ed9198e7391ad300d99133818b271d23:2024030483,e4684f3eaf1693002019808e04d2c6f3:1393366783,08644bbab116930080271ee01e92f1e7:-339299198,afb3c3babf16930070d18ae6e8cc4e7a:1411950891,71a34b3a7f16930054f8924d5b96197c:129615693,00f0433a4316930064abfc8ebb5d9823:-144072004,0dcabe368a169300853ddef7d1db2fe6:1288834507,336a3a360c169300ec1f5a4937195df8:-161266019,f469feb26616930082b811c910811903:-708362339,9f187e72dc169300dfe3c70f986f77bd:-333097782,b6573efebdd2930095289652f56465c8:-864184942,93753efec4d29300b522b1be373b54c2:959388866,a7c47e7e37d2930059ceaa1e21cfe5ef:-554236393,5e9aa6f6f1d29300da8eb275501c6a29:-2058353522,c1496e369bd293000e6c5abeeaa50733:-1095736062,1c20ae7aa956df00bcf89b92e10e0ae5:-643951813,6e6f5e3e4d56df00a0c03e934a1a822f:-527518582,6c9edaba9896df006b5910bc745cfa3c:778447343,26e082b60256df00143fc38799e428ad:-1062469659,eb39b9b2ad56df006f79632251155dc8:2024427394,881f491552529b0033d6c29387d4bf0f:2032238305,0a5e011181529b000fdde17eef3def83:-1075160591,ea18415153529b0064eab1de491bc621:-6890014,bdf7c59d01129b001423e7aaea248aac:-1434059075,5ad5c59d60129b0047432bda3e95bef4:1253601649,bbb37455ac129b00faa8d17c179858cf:-1992214228,7232345545129b00fb65ce7a0a703fa1:496527116,9bbda051c2129b007e1a6d2985d78db5:1781045456,de4ae419f3de5b008b555d6c79a54fe3:-723601656,4203ac1d3ede5b006618d823ab617896:1908294079,5a495895b6de5b0044f5380ff50c7e5f:-1371753776,85f6d8d15dde5b0008c176d65da616d5:45003350,165604d9209e5b00d31ee8dab18f21fa:648340869,aa04c8d9f69e5b00afe4dd51aa150b8e:-667673171</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sysevent_email_template_ed2852386fa54100091f52a03f3ee44c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sysevent_email_template"&gt;&lt;sysevent_email_template action="INSERT_OR_UPDATE"&gt;&lt;collection&gt;incident&lt;/collection&gt;&lt;email_layout/&gt;&lt;message&gt;&lt;![CDATA[Thank you for contacting the UC Davis Service Desk. We have received your request ${number} and are working to resolve your issue as quickly as possible. We will contact you via email when we have come to a resolution.

Subject: ${short_description}

Sincerely,
The UC Davis Service Desk]]&gt;&lt;/message&gt;&lt;message_html&gt;&lt;![CDATA[&lt;div&gt;${mail_script:incident_add_announcement}&lt;/div&gt;
&lt;div&gt;${mail_script:incident_personalize_salutation}&amp;nbsp;&lt;/div&gt;
&lt;div&gt;${mail_script:incident_thanks_for_contacting}&lt;/div&gt;
&lt;div&gt;${mail_script:incident_telephone}&lt;/div&gt;
&lt;div&gt;${mail_script:incident_after_hours_info}&lt;/div&gt;
&lt;div&gt;Subject: ${short_description}&lt;/div&gt;
&lt;div&gt;${mail_script:incident_include_relevant_kb}&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;If you are a UC Davis affiliate with a login ID, you can check the status of your ticket at the &lt;a href="/ess/incident_status.do"&gt;Service Hub&lt;/a&gt;.&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Sincerely,&amp;nbsp;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;${mail_script:incident_email_from_and_sig}&lt;/div&gt;
&lt;div&gt;${comments}&lt;/div&gt;]]&gt;&lt;/message_html&gt;&lt;message_list/&gt;&lt;message_text/&gt;&lt;name&gt;user.incident.opened&lt;/name&gt;&lt;sms_alternate/&gt;&lt;subject&gt;${number} "${short_description}" - Opened&lt;/subject&gt;&lt;sys_class_name&gt;sysevent_email_template&lt;/sys_class_name&gt;&lt;sys_created_by&gt;ahorst&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2013-05-22 17:20:24&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;ed2852386fa54100091f52a03f3ee44c&lt;/sys_id&gt;&lt;sys_mod_count&gt;24&lt;/sys_mod_count&gt;&lt;sys_name&gt;user.incident.opened&lt;/sys_name&gt;&lt;sys_package/&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_email_template_ed2852386fa54100091f52a03f3ee44c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-05-24 16:27:08&lt;/sys_updated_on&gt;&lt;sys_version&gt;2&lt;/sys_version&gt;&lt;/sysevent_email_template&gt;&lt;/record_update&gt;</payload>
<payload_hash>1076955962</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifica">22bfcb124f3fd3400d952b8ca310c765</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>eabf83524f3fd3400d952b8ca310c71a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e12436c80000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>user.incident.opened</target_name>
<type>Email Template</type>
<update_domain>global</update_domain>
<update_guid>4d86885da09e5b00d72d610a0df2b8e2</update_guid>
<update_guid_history>4d86885da09e5b00d72d610a0df2b8e2:1076955962,578c7c39a8af4b40a63def9ac690bcc8:1385671995,-1809033391:-1809033391,505185134:505185134,-2119001638:-2119001638,1303778171:1303778171,1359241990:1359241990,634080518:634080518,2144513456:2144513456,1402865748:1402865748,-1334039207:-1334039207,635350325:635350325,1478656997:1478656997,-95979141:-95979141,-474635974:-474635974,670522429:670522429,421646995:421646995,-1037959333:-1037959333</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_instance_b10635321356df0093625dcf3244b06b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_instance"><sp_instance action="INSERT_OR_UPDATE"><active>true</active><class_name/><color>default</color><css/><glyph/><id/><order>1</order><roles/><short_description/><size>md</size><sp_column display_value="1">bd0635321356df0093625dcf3244b068</sp_column><sp_widget display_value="Incident Close Link">a10631fe1316df0093625dcf3244b08c</sp_widget><sys_class_name>sp_instance</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-05-29 16:25:14</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>b10635321356df0093625dcf3244b06b</sys_id><sys_mod_count>0</sys_mod_count><sys_name/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_instance_b10635321356df0093625dcf3244b06b</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-05-29 16:25:14</sys_updated_on><title/><url/><widget_parameters/></sp_instance></record_update>]]></payload>
<payload_hash>382331876</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifica">22bfcb124f3fd3400d952b8ca310c765</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>eebf83524f3fd3400d952b8ca310c719</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e12436c80000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>incident_close_link</target_name>
<type>Instance</type>
<update_domain>global</update_domain>
<update_guid>b5063532f956df004ad6f62eb98f7a6c</update_guid>
<update_guid_history>b5063532f956df004ad6f62eb98f7a6c:382331876</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_script_include_e291955e0f72db406717590be1050e8b</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;&lt;sys_script_include action="DELETE"&gt;&lt;access&gt;public&lt;/access&gt;&lt;active&gt;true&lt;/active&gt;&lt;api_name&gt;global.closeIncidentFromEmail&lt;/api_name&gt;&lt;client_callable&gt;true&lt;/client_callable&gt;&lt;description/&gt;&lt;name&gt;closeIncidentFromEmail&lt;/name&gt;&lt;script&gt;&lt;![CDATA[var closeIncidentFromEmail = Class.create();
closeIncidentFromEmail.prototype = Object.extendsObject(AbstractAjaxProcessor, {
	closeIncident: function () {
		inc_id = this.getParameter('sysparm_inc_id');
		kb_id = this.getParameter('sysparm_kb_id');
		var gr_inc = new GlideRecord("incident");
		gr_inc.addQuery("sys_id", inc_id);
		gr_inc.query();
		gs.log('earl:3 hello');
		
		if (gr_inc.next()) {
			if (gr_inc.state == 6 || gr_inc.state == 7)
				return;
			
			var gr_kb = new GlideRecord("kb_knowledge");
			gr_kb.addQuery("sys_id", kb_id);
			gr_kb.query();
			
			if (gr_kb.next()) {
				gr_inc.state = 7;
				gr_inc.close_code = "Closed by KB";
				
				//var kbLink = gs.generateURL("kb_knowledge", gr_kb.number);
				var kbLink = "servicehub/?id=ucd_kb_article&amp;sys_id=" + gr_kb.number;

				// journal format: "Resolved by Caller using [KB Number] - [KB Article Title]."
				var journalString =
						"[code]" +
						"Resolved by Caller using " +
						gr_kb.number +
						" - " +
						"&lt;a href=" + kbLink + "&gt;" + gr_kb.short_description + "&lt;/a&gt;" + 
						"." +
						"[/code]";
				gr_inc.comments.setJournalEntry(journalString, "System");

				gr_inc.update();	
				var results = {
					"number" : gr_inc.number + ''
				};
				return json.encode(results);
			}
		}       
	},
	isPublic: function() {
		return true;
	}
});]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-eduque&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-06-21 21:05:51&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;e291955e0f72db406717590be1050e8b&lt;/sys_id&gt;&lt;sys_mod_count&gt;3&lt;/sys_mod_count&gt;&lt;sys_name&gt;closeIncidentFromEmail&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_include_e291955e0f72db406717590be1050e8b&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-eduque&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-21 21:17:50&lt;/sys_updated_on&gt;&lt;/sys_script_include&gt;&lt;/record_update&gt;</payload>
<payload_hash>-386982529</payload_hash>
<remote_update_set display_value="IET STRY0058384 Re-design: Link in &quot;Solved by KB article&quot; email lead to serviceh">26bfcb124f3fd3400d952b8ca310c75b</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>6ebfcb124f3fd3400d952b8ca310c75b</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461ded5980000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table/>
<target_name>closeIncidentFromEmail</target_name>
<type>Script Include</type>
<update_domain>global</update_domain>
<update_guid>1f181552eeb2db40b1dfc06fa423da2c</update_guid>
<update_guid_history>1f181552eeb2db40b1dfc06fa423da2c:-386982529,08955dde6872db40f48e8bd160e3978d:2052894579,bcb4d5de5172db4034f676aff5755511:1698185826,25a311decd72db4081eda4826bbd390e:-48119185,60d2d19ef172db40a3cf9f0f2862f165:-731136486</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_widget_a10631fe1316df0093625dcf3244b08c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;client_script&gt;&lt;![CDATA[function(spUtil) {
  /* widget controller */
  var c = this;
	
	//function to extract fields from url
	function gup( name, url ) {
    if (!url) url = location.href;
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regexS = "[\\?&amp;]"+name+"=([^&amp;#]*)";
    var regex = new RegExp( regexS );
    var results = regex.exec( url );
    return results == null ? null : results[1];
	}
	//gup('q', 'hxxp://example.com/?q=abc')
	//alert(window.location.href)
	//alert(gup("inc", window.location.href))
	
	//console.log("inc: " + gup("inc", window.location.href));
	//console.log("kb: " + gup("kb", window.location.href));

	//onload, send incident id and kb id to server to resolve the inc
	//and notify
	c.data.inc_id = gup("inc", window.location.href);
	c.data.kb_id = gup("kb", window.location.href);
	if (c.data.inc_id || c.data.kb_id) {
		c.server.update().then(
			function() {
				c.data.inc_id = undefined;
				c.data.kb_id = undefined;
				spUtil.addInfoMessage("Thank you, your ticket (" + c.data.inc_num + ") has been closed.");
			});
	}	
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css/&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;true&lt;/has_preview&gt;&lt;id&gt;incident-close-link&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link/&gt;&lt;name&gt;Incident Close Link&lt;/name&gt;&lt;option_schema/&gt;&lt;public&gt;true&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {	
	/*
		incident state codes:
		1 new
		6 resolved
		7 closed
	*/
	
	if (input &amp;&amp; input.inc_id &amp;&amp; input.kb_id) {
		var gr_inc = new GlideRecord("incident");
		gr_inc.addQuery("sys_id", input.inc_id);
		gr_inc.query();
		
		if (gr_inc.next()) {
			if (gr_inc.state == 6 || gr_inc.state == 7){
				return;
			}
			var gr_kb = new GlideRecord("kb_knowledge");
			gr_kb.addQuery("sys_id", input.kb_id);
			gr_kb.query();
			
			if (gr_kb.next()) {
				gr_inc.state = 7;
				gr_inc.close_code = "Closed by KB";
				
				//var kbLink = gs.generateURL("kb_knowledge", gr_kb.number);
				var kbLink = "servicehub/?id=ucd_kb_article&amp;sys_id=" + gr_kb.number;

				// journal format: "Resolved by Caller using [KB Number] - [KB Article Title]."
				var journalString =
						"[code]" +
						"Resolved by Caller using " +
						gr_kb.number +
						" - " +
						"&lt;a href=" + kbLink + "&gt;" + gr_kb.short_description + "&lt;/a&gt;" + 
						"." +
						"[/code]";
				gr_inc.comments = journalString;

				gr_inc.update();
				data.inc_num = gr_inc.number + "";
			}
		}
	}
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-29 16:25:14&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;a10631fe1316df0093625dcf3244b08c&lt;/sys_id&gt;&lt;sys_mod_count&gt;82&lt;/sys_mod_count&gt;&lt;sys_name&gt;Incident Close Link&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_a10631fe1316df0093625dcf3244b08c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-eduque&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-21 21:33:36&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div&gt;
  &lt;!-- your widget template --&gt;
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>-643577401</payload_hash>
<remote_update_set display_value="IET STRY0058384 Re-design: Link in &quot;Solved by KB article&quot; email lead to serviceh">26bfcb124f3fd3400d952b8ca310c75b</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>aabfcb124f3fd3400d952b8ca310c75b</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461ded5980000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table/>
<target_name>Incident Close Link</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>d3291552fcb2db4064579d224753e7d4</update_guid>
<update_guid_history>d3291552fcb2db4064579d224753e7d4:-643577401,3a48511214b2db406f4f6551c6a5307c:-53470841,8655d9de8272db4045a395ac8e8a7483:-1332219562,f4455ddef972db40cd71a7a991f9bf1b:23869032,2315d9deb572db401e3a00683081f541:770511766,4e151dde1972db406fef09f3c76dc323:-541684485,da0519de1872db40d30daedbb363fafb:-1278735037,4ff41dde7472db40734dac8f91e4471c:-959306622,e9e4d5de6672db4031f23307336fb969:-1107515906,749451de6d72db40eeaa1d0141852ce2:-768827408,9f6495de4572db40054870fdd38cc6df:-1910802865,a15495dece72db409afba939c0ba1330:-1572316039,79e3dd9e3272db40488f7361014310a7:2048328630,9e7311debb72db40cb3cfdf1f94cb705:9507030,27f0d91ed272db40f5a41ba4bb416acb:-2063895740,6680111e0272db40f6b10fb664f7b2ab:-2033759588,1940191e4172db40244c8deca29fbe61:1592097301,697f8ddaae72db40ead6c4114cd7d2a5:-2063895740,573f89da2972db406c8f54a114a6e458:1354978836,9c8ec55a5672db409056318b8bbda735:469701850,5c5e4d1ab372db4031793b84a49be2d6:-567779131,5ddd0d1a7f72db400689f95c262bf41a:1491151035,abcd015ae572db40ee76ad0be387b508:-1396892183,d7bd4d1a5072db404ef21615679d3809:1491151035,75cc8996ac72db40d990ec9767f16024:1745076636,ccac49964472db409d4704aa866d80f3:966702844,af4c8996a072db403edb97dd4541db53:723942172,33c39e51d2bedf40500255c82100cce1:254146920,af4a861d5f7edf4085a705ccabcfbf91:-928011762,6048c699977edf408b71cc6a6ade029b:938491812,ccb64e593a7edf4064568f46f38cb54f:-906563266,2ac50259ff7edf4074e0dbba9b051a6c:-852079009,08e44a19537edf4002e7dc7b41f5fde4:-90716788,dce30ed5f27edf405e4e8bd3ba5c1724:-57652464,9592c255227edf40f5140c407583b544:439496414,d70c79d1ef7edf40c90694ce98a8547f:1470383192,3da6b151c77edf40e5f9e586f05726a6:1736450287,ef65fd9d343edf40f1d1c152f5eb6ffa:1425166224,22b43dddcc3edf400422b589769319d9:-536378192,d4c1759d703edf40afce9ffba2e84678:55366422,22fee91d8d3edf409490a35a41dce5b5:-813008820,3e0ea11d563edf40191c712a614b27d8:1524677516,6afce959533edf4045f3d8a59a67781a:545343513,c7dce9194d3edf40b60a5ea9ceeb1162:-194719492,f44c2959123edf406ae6eb6ca40436de:1742275129,857d0995ccfadf4000c6603e5f7a0723:-693955731,388a9a025f621b400ed9cfa346c84bcb:1314774407,3458368d3a22d700086fb186d69492f2:1737855977,ecb166c54422d7002b5f6e8c3567d06d:244790540,7ccbd12fc6dad30033859879033ebbf6:1613598326,2364852fe49ad3007e011867317a1b12:1781556162,47d309eb809ad30027ce867556a360e1:-1819011998,6292cdabd39ad300fae2a3337118ef51:-1904565963,e34e7ce7049ad300b25f08140080e5f1:-302582566,256cb4a7209ad3004c6ecc7eb8edb3fa:-166846082,7a4cb4a7d29ad3005e11f5d10bd32d54:1628175183,ed3c34a71b9ad30038daaf610dfba863:2054336,54cbbc677c9ad300e6b602d41d9bf635:188141296,2b9bf4a3529ad3009dc063a4c148140b:-1127112208,b21ab427e09ad300ac16843dbeab704e:-304914590,afcbf936d456df000864f05b5dcffa10:1243862241,969bfdb29956df006ea68e1f0da4e73c:-1154578685,f49bb9367d56df00cf28ea3105a7be2d:1405811870,c37b31b21356df00c4702f57c2030a9a:-1108135387,b82bb9b25056df00227bba2c42aef9c1:452376687,fbb871b27256df00499cff2b4025724a:349372834,5ba83d724956df0071365bf85e82f8f8:-1811038098,e15831b2b256df00ecea89e9d362235b:1090736169,444871b20056df00572b7655d0b76343:-1243757800,493839722e56df00b6c99672e9ae7eb4:635086784,af2831b28556df00ad54246593999540:821013785,9d2839726656df00554e8d6a584165ad:-98462806,9418f5327a56df00054614a847133f00:-1045176205,c7e7f9725f56df00f31725fb078d5881:2109700040,5bd7b972df56df00f4acb25d778d7b3e:-993690448,eac7f9720a56df0022051f280ac00d7a:-912124522,4ba7b972de56df006d1925ee7e2d4f37:-1868011490,8b7735329b56df002745196d9300db71:-186816256,0d677dfea716df00affd360a94e608b9:1351271116,fc373d327756df00fa2dfc4040eea6c7:-681331990,3196fd322256df00f44201aa5e4294c7:-1219586856,8f76bd327c56df00bfb915c75507ff64:-2056561234,e50631fe5816df00f282617fcdaf788d:1406429426</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_page_290631fe1316df0093625dcf3244b08f</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_page"><sp_page action="INSERT_OR_UPDATE"><css/><draft>false</draft><id>incident_close_link</id><internal>false</internal><public>true</public><roles/><short_description/><sys_class_name>sp_page</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-05-29 16:25:14</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>290631fe1316df0093625dcf3244b08f</sys_id><sys_mod_count>1</sys_mod_count><sys_name>incident_close_link</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_page_290631fe1316df0093625dcf3244b08f</sys_update_name><sys_updated_by>admin-eduque</sys_updated_by><sys_updated_on>2018-06-21 20:42:22</sys_updated_on><title>Incident Close Link - Test Page</title></sp_page></record_update>]]></payload>
<payload_hash>1008535652</payload_hash>
<remote_update_set display_value="IET STRY0058384 Re-design: Link in &quot;Solved by KB article&quot; email lead to serviceh">26bfcb124f3fd3400d952b8ca310c75b</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>e6bfcb124f3fd3400d952b8ca310c75b</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461ded5980000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table/>
<target_name>incident_close_link</target_name>
<type>Page</type>
<update_domain>global</update_domain>
<update_guid>3c7d451a3972db40bd726fffbc98b205</update_guid>
<update_guid_history>3c7d451a3972db40bd726fffbc98b205:1008535652,b90631febc16df00dc6484dab53a9b90:-905003901</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_widget_a10631fe1316df0093625dcf3244b08c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;client_script&gt;&lt;![CDATA[function() {
  /* widget controller */
  var c = this;
	
	//function to extract fields from url
	function gup( name, url ) {
    if (!url) url = location.href;
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regexS = "[\\?&amp;]"+name+"=([^&amp;#]*)";
    var regex = new RegExp( regexS );
    var results = regex.exec( url );
    return results == null ? null : results[1];
	}
	//gup('q', 'hxxp://example.com/?q=abc')
	//alert(window.location.href)
	//alert(gup("inc", window.location.href))
	
	//console.log("inc: " + gup("inc", window.location.href));
	//console.log("kb: " + gup("kb", window.location.href));

	//onload, send incident id and kb id to server to resolve the inc
	//and notify
	c.data.inc_id = gup("inc", window.location.href);
	c.data.kb_id = gup("kb", window.location.href);
	if (c.data.inc_id || c.data.kb_id) {
		c.server.update().then(
			function() {
				c.data.inc_id = undefined;
				c.data.kb_id = undefined;
			});
	}	
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css/&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;true&lt;/has_preview&gt;&lt;id&gt;incident-close-link&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link/&gt;&lt;name&gt;Incident Close Link&lt;/name&gt;&lt;option_schema/&gt;&lt;public&gt;true&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {	
	/*
		incident state codes:
		1 new
		6 resolved
		7 closed
	*/
		
	if (input &amp;&amp; input.inc_id &amp;&amp; input.kb_id) {
		var gr_inc = new GlideRecord("incident");
		gr_inc.addQuery("sys_id", input.inc_id);
		gr_inc.query();
		
		if (gr_inc.next()) {
			if (gr_inc.state == 6 || gr_inc.state == 7)
				return;
			
			var gr_kb = new GlideRecord("kb_knowledge");
			gr_kb.addQuery("sys_id", input.kb_id);
			gr_kb.query();
			
			if (gr_kb.next()) {
				gr_inc.state = 7;
				gr_inc.close_code = "Closed by KB";
				
				//var kbLink = gs.generateURL("kb_knowledge", gr_kb.number);
				var kbLink = "servicehub/?id=ucd_kb_article&amp;sys_id=" + gr_kb.number;

				// journal format: "Resolved by Caller using [KB Number] - [KB Article Title]."
				var journalString =
						"[code]" +
						"Resolved by Caller using " +
						gr_kb.number +
						" - " +
						"&lt;a href=" + kbLink + "&gt;" + gr_kb.short_description + "&lt;/a&gt;" + 
						"." +
						"[/code]";
				gr_inc.comments.setJournalEntry(journalString, "System");

				gr_inc.update();				
			}
		}
	}
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-29 16:25:14&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;a10631fe1316df0093625dcf3244b08c&lt;/sys_id&gt;&lt;sys_mod_count&gt;55&lt;/sys_mod_count&gt;&lt;sys_name&gt;Incident Close Link&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_a10631fe1316df0093625dcf3244b08c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-bgerrity&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-18 23:15:51&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div&gt;
&lt;!-- your widget template --&gt;
  &lt;div&gt;
    Thank you,
  &lt;/div&gt;
  &lt;div&gt;
    Your ticket has been closed.
  &lt;/div&gt;
  
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>254146920</payload_hash>
<remote_update_set display_value="IET STRY0058307 Enhancement - Incident Emails: Add knowledge article title/link ">2abfcb124f3fd3400d952b8ca310c762</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>aebfcb124f3fd3400d952b8ca310c762</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641a1cc7380000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table/>
<target_name>Incident Close Link</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>33c39e51d2bedf40500255c82100cce1</update_guid>
<update_guid_history>33c39e51d2bedf40500255c82100cce1:254146920,af4a861d5f7edf4085a705ccabcfbf91:-928011762,6048c699977edf408b71cc6a6ade029b:938491812,ccb64e593a7edf4064568f46f38cb54f:-906563266,2ac50259ff7edf4074e0dbba9b051a6c:-852079009,08e44a19537edf4002e7dc7b41f5fde4:-90716788,dce30ed5f27edf405e4e8bd3ba5c1724:-57652464,9592c255227edf40f5140c407583b544:439496414,d70c79d1ef7edf40c90694ce98a8547f:1470383192,3da6b151c77edf40e5f9e586f05726a6:1736450287,ef65fd9d343edf40f1d1c152f5eb6ffa:1425166224,22b43dddcc3edf400422b589769319d9:-536378192,d4c1759d703edf40afce9ffba2e84678:55366422,22fee91d8d3edf409490a35a41dce5b5:-813008820,3e0ea11d563edf40191c712a614b27d8:1524677516,6afce959533edf4045f3d8a59a67781a:545343513,c7dce9194d3edf40b60a5ea9ceeb1162:-194719492,f44c2959123edf406ae6eb6ca40436de:1742275129,857d0995ccfadf4000c6603e5f7a0723:-693955731,388a9a025f621b400ed9cfa346c84bcb:1314774407,3458368d3a22d700086fb186d69492f2:1737855977,ecb166c54422d7002b5f6e8c3567d06d:244790540,7ccbd12fc6dad30033859879033ebbf6:1613598326,2364852fe49ad3007e011867317a1b12:1781556162,47d309eb809ad30027ce867556a360e1:-1819011998,6292cdabd39ad300fae2a3337118ef51:-1904565963,e34e7ce7049ad300b25f08140080e5f1:-302582566,256cb4a7209ad3004c6ecc7eb8edb3fa:-166846082,7a4cb4a7d29ad3005e11f5d10bd32d54:1628175183,ed3c34a71b9ad30038daaf610dfba863:2054336,54cbbc677c9ad300e6b602d41d9bf635:188141296,2b9bf4a3529ad3009dc063a4c148140b:-1127112208,b21ab427e09ad300ac16843dbeab704e:-304914590,afcbf936d456df000864f05b5dcffa10:1243862241,969bfdb29956df006ea68e1f0da4e73c:-1154578685,f49bb9367d56df00cf28ea3105a7be2d:1405811870,c37b31b21356df00c4702f57c2030a9a:-1108135387,b82bb9b25056df00227bba2c42aef9c1:452376687,fbb871b27256df00499cff2b4025724a:349372834,5ba83d724956df0071365bf85e82f8f8:-1811038098,e15831b2b256df00ecea89e9d362235b:1090736169,444871b20056df00572b7655d0b76343:-1243757800,493839722e56df00b6c99672e9ae7eb4:635086784,af2831b28556df00ad54246593999540:821013785,9d2839726656df00554e8d6a584165ad:-98462806,9418f5327a56df00054614a847133f00:-1045176205,c7e7f9725f56df00f31725fb078d5881:2109700040,5bd7b972df56df00f4acb25d778d7b3e:-993690448,eac7f9720a56df0022051f280ac00d7a:-912124522,4ba7b972de56df006d1925ee7e2d4f37:-1868011490,8b7735329b56df002745196d9300db71:-186816256,0d677dfea716df00affd360a94e608b9:1351271116,fc373d327756df00fa2dfc4040eea6c7:-681331990,3196fd322256df00f44201aa5e4294c7:-1219586856,8f76bd327c56df00bfb915c75507ff64:-2056561234,e50631fe5816df00f282617fcdaf788d:1406429426</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_widget_967d895513fadf403527bd122244b0d6</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="DELETE"&gt;&lt;client_script&gt;&lt;![CDATA[function() {
  /* widget controller */
  var c = this;
	
	//function to extract fields from url
	function gup( name, url ) {
    if (!url) url = location.href;
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regexS = "[\\?&amp;]"+name+"=([^&amp;#]*)";
    var regex = new RegExp( regexS );
    var results = regex.exec( url );
    return results == null ? null : results[1];
	}
	//gup('q', 'hxxp://example.com/?q=abc')
	//alert(window.location.href)
	//alert(gup("inc", window.location.href))
	
	console.log("inc: " + gup("inc", window.location.href));
	console.log("kb: " + gup("kb", window.location.href));
	
	//onload, send id to server to resolve the inc
	c.data.inc_id = gup("inc", window.location.href);
	if (c.data.inc_id){
		c.server.update().then(function(){
			c.data.inc_id = undefined;
		});
	}
	
	/* original
	//do something with the given KB too eventually
	c.data.kb = gup("kb", window.location.href);
	*/
	
	// story: enhancement add kb title/link
	//do something with the given KB too eventually
	c.data.kb = gup("kb", window.location.href);
		if (c.data.kb){
		c.server.update().then(function(){
			c.data.kb = undefined;
		});
	}
	
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css/&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;true&lt;/has_preview&gt;&lt;id/&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link/&gt;&lt;name&gt;Copy of Incident Close Link&lt;/name&gt;&lt;option_schema/&gt;&lt;public&gt;true&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
	
	//var temp = "27a11ce7131ad300d26f5e7f3244b0ed"; //random inc
	
	//client gave me the inc to remove
	//widget should set 
	//state -&gt; resolved (6)
	//close_code -&gt; resolved by caller "Resolved by Caller"
	//add comment "resolved by caller"
	
	if (input &amp;&amp; input.inc_id){
		var gr = new GlideRecord("incident");
		gr.addQuery("sys_id", input.inc_id);
		//gr.addQuery("sys_id", temp);
		gr.query();
		
		if (gr.next()){
			if (gr.state == 6 || gr.state == 7){
				return;
			}
			
			gr.state = 6;
			gr.close_code = "Closed by KB";
			gr.comments.setJournalEntry("Resolved by Caller.", "System");

			gr.update();
		}
	}
	

	//test
	/*
	var gr = new GlideRecord("incident");
	gr.addQuery("sys_id", "5440f13613529300d26f5e7f3244b071");
	gr.query()

	if (gr.next()){
		//gs.addInfoMessage(gr.state);
		gr.state = 1;
		gr.update();
	}

	//incident state codes
	//1 new
	//6 resolved
	//7 closed
	*/
	
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-bgerrity&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-06-18 18:08:33&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;967d895513fadf403527bd122244b0d6&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Copy of Incident Close Link&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_967d895513fadf403527bd122244b0d6&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-bgerrity&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-18 18:08:33&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div&gt;
&lt;!-- your widget template --&gt;
  &lt;div&gt;
    Thank you,
  &lt;/div&gt;
  &lt;div&gt;
    Your ticket has been closed.
  &lt;/div&gt;
 
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1585996550</payload_hash>
<remote_update_set display_value="IET STRY0058307 Enhancement - Incident Emails: Add knowledge article title/link ">2abfcb124f3fd3400d952b8ca310c762</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>eabfcb124f3fd3400d952b8ca310c762</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641a1cc7380000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table/>
<target_name>Copy of Incident Close Link</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>388d4d55fcfadf40f6da3e356ff799af</update_guid>
<update_guid_history>388d4d55fcfadf40f6da3e356ff799af:-1585996550,d67d8955fcfadf400128d90d55f218d7:583362950</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_documentation_sys_user_group_u_attach_kb_3_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_attach_kb_3" label="Article 3" language="en" table="sys_user_group"><sys_documentation action="INSERT_OR_UPDATE"><element>u_attach_kb_3</element><help/><hint/><label>Article 3</label><language>en</language><name>sys_user_group</name><plural>Article 3s</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>30d6960e13221b403527bd122244b0d2</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Article 3</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_sys_user_group_u_attach_kb_3_en</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>-380474463</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>22bfcb124f3fd3400d952b8ca310c75e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af7990000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Article 3</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>09d6d60e33221b40da6eb4f65cf3c816</update_guid>
<update_guid_history>09d6d60e33221b40da6eb4f65cf3c816:-380474463</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_dictionary_sys_user_group_u_attach_kb_enable</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_attach_kb_enable" table="sys_user_group"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Enable KB attachment?</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_attach_kb_enable</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="">boolean</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>sys_user_group</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>f0d6960e13221b403527bd122244b0d3</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Enable KB attachment?</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_sys_user_group_u_attach_kb_enable</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-1119139589</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>26bfcb124f3fd3400d952b8ca310c75d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af5b60000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Enable KB attachment?</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>b8d6d60e8c221b40fd5ae348491c9205</update_guid>
<update_guid_history>b8d6d60e8c221b40fd5ae348491c9205:-1119139589</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_choice_sys_user_group_u_attach_kb_method</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_choice action="INSERT_OR_UPDATE" field="u_attach_kb_method" table="sys_user_group" version="3"><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>u_attach_kb_method</element><hint/><inactive>false</inactive><label>Automatic</label><language>en</language><name>sys_user_group</name><sequence>0</sequence><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:53</sys_created_on><sys_domain>global</sys_domain><sys_id>d6d6d60e13221b403527bd122244b0c9</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:53</sys_updated_on><value>Automatic</value></sys_choice><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>u_attach_kb_method</element><hint/><inactive>false</inactive><label>Manual</label><language>en</language><name>sys_user_group</name><sequence>1</sequence><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:53</sys_created_on><sys_domain>global</sys_domain><sys_id>5ad6d60e13221b403527bd122244b0ca</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:53</sys_updated_on><value>Manual</value></sys_choice><sys_choice_set action="INSERT_OR_UPDATE"><element>u_attach_kb_method</element><name>sys_user_group</name><sys_class_name>sys_choice_set</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:53</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>16d6d60e13221b403527bd122244b0ca</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_attach_kb_method</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_choice_sys_user_group_u_attach_kb_method</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:53</sys_updated_on></sys_choice_set></sys_choice></record_update>]]></payload>
<payload_hash>-1031911743</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>2abfcb124f3fd3400d952b8ca310c75c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13b0b8a0000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Attachment method</target_name>
<type>Choice list</type>
<update_domain>global</update_domain>
<update_guid>1ad6d60e4d221b408335c17fa87465cc</update_guid>
<update_guid_history>1ad6d60e4d221b408335c17fa87465cc:-1031911743</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_policy_action_c578528e13221b403527bd122244b008</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_policy_action"><sys_ui_policy_action action="DELETE"><disabled>ignore</disabled><field>u_attach_kb_2</field><mandatory>ignore</mandatory><sys_class_name>sys_ui_policy_action</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:15:58</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>c578528e13221b403527bd122244b008</sys_id><sys_mod_count>1</sys_mod_count><sys_name>u_attach_kb_2</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_policy_action_c578528e13221b403527bd122244b008</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:16:07</sys_updated_on><table>sys_user_group</table><ui_policy display_value="Show/hide attach kb fields">98281a4e13221b403527bd122244b0f9</ui_policy><visible>false</visible></sys_ui_policy_action></record_update>]]></payload>
<payload_hash>-2091736463</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>2abfcb124f3fd3400d952b8ca310c75f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e142e8fe0000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>u_attach_kb_2</target_name>
<type>UI Policy Action</type>
<update_domain>global</update_domain>
<update_guid>80d8168eeb221b40dc4e687f52cb5cee</update_guid>
<update_guid_history>80d8168eeb221b40dc4e687f52cb5cee:-2091736463,9088528eb6221b40295dc56df6b542ef:413800549,4678128e32221b40c281d20f83651d1e:-1405074370</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_form_sections_e3d20b54136772403527bd122244b097</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_form_sections form_id="e3d20b54136772403527bd122244b097" sys_domain="global" table="sys_user_group" version="3"><sys_ui_form_section action="INSERT_OR_UPDATE"><position>0</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-29 18:00:14</sys_created_on><sys_domain>global</sys_domain><sys_id>e6c2885b4f011300b22a00f18110c770</sys_id><sys_mod_count>0</sys_mod_count><sys_overrides/><sys_ui_form display_value="sys_user_group" name="sys_user_group" sys_domain="global" view="Default view">e3d20b54136772403527bd122244b097</sys_ui_form><sys_ui_section caption="NULL" display_value="" name="sys_user_group" sys_domain="global" view="Default view">0e58739fc0a8016400e2e29c13e3798d</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-29 18:00:14</sys_updated_on></sys_ui_form_section><sys_ui_form_section action="INSERT_OR_UPDATE"><position>1</position><sys_created_by>admin-eduque</sys_created_by><sys_created_on>2018-05-03 21:49:07</sys_created_on><sys_domain>global</sys_domain><sys_id>78d6812a133913003527bd122244b0a9</sys_id><sys_mod_count>1</sys_mod_count><sys_overrides/><sys_ui_form display_value="sys_user_group" name="sys_user_group" sys_domain="global" view="Default view">e3d20b54136772403527bd122244b097</sys_ui_form><sys_ui_section caption="Customize Incident Email Notifications" display_value="Customize Incident Email Notifications" name="sys_user_group" sys_domain="global" view="Default view">f4d6412a133913003527bd122244b056</sys_ui_section><sys_updated_by>admin-eduque</sys_updated_by><sys_updated_on>2018-05-03 21:49:08</sys_updated_on></sys_ui_form_section><sys_ui_form_section action="INSERT_OR_UPDATE"><position>2</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-29 18:00:14</sys_created_on><sys_domain>global</sys_domain><sys_id>e2c2885b4f011300b22a00f18110c771</sys_id><sys_mod_count>1</sys_mod_count><sys_overrides/><sys_ui_form display_value="sys_user_group" name="sys_user_group" sys_domain="global" view="Default view">e3d20b54136772403527bd122244b097</sys_ui_form><sys_ui_section caption="Queue Manager" display_value="Queue Manager" name="sys_user_group" sys_domain="global" view="Default view">92c2885b4f011300b22a00f18110c76c</sys_ui_section><sys_updated_by>admin-eduque</sys_updated_by><sys_updated_on>2018-05-03 21:49:08</sys_updated_on></sys_ui_form_section><sys_ui_form_section action="INSERT_OR_UPDATE"><position>3</position><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_domain>global</sys_domain><sys_id>e0d6960e13221b403527bd122244b05c</sys_id><sys_mod_count>0</sys_mod_count><sys_overrides/><sys_ui_form display_value="sys_user_group" name="sys_user_group" sys_domain="global" view="Default view">e3d20b54136772403527bd122244b097</sys_ui_form><sys_ui_section caption="Attach KB to Incident Notification" display_value="Attach KB to Incident Notification" name="sys_user_group" sys_domain="global" view="Default view">e8d6960e13221b403527bd122244b058</sys_ui_section><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on></sys_ui_form_section><sys_ui_form action="INSERT_OR_UPDATE"><name>sys_user_group</name><roles/><sys_class_name>sys_ui_form</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-29 18:00:13</sys_created_on><sys_customer_update>false</sys_customer_update><sys_domain>global</sys_domain><sys_id>e3d20b54136772403527bd122244b097</sys_id><sys_mod_count>0</sys_mod_count><sys_name>sys_user_group</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_form_sections_e3d20b54136772403527bd122244b097</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-29 18:00:13</sys_updated_on><sys_user/><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_form></sys_ui_form_sections></record_update>]]></payload>
<payload_hash>-701258262</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>2ebfcb124f3fd3400d952b8ca310c75e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af16c0000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group</target_name>
<type>Form Sections</type>
<update_domain>global</update_domain>
<update_guid>ecd6960e97221b40dbf7ad8fafe0785d</update_guid>
<update_guid_history>ecd6960e97221b40dbf7ad8fafe0785d:-701258262,8dd6812abd391300028935f7564daab0:-1350065169,b0d6812a74391300e83ccbd3012582ab:-166870649,6ac2c85b9c01130008c67571c79fd414:-1603649935,6ac2885b26011300b33fd6ae419b056e:809704007</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_dictionary_sys_user_group_u_attach_kb_3</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_attach_kb_3" table="sys_user_group"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Article 3</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_attach_kb_3</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>sys_user_group</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="" name="kb_knowledge">kb_knowledge</reference><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>bcd6960e13221b403527bd122244b0d0</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Article 3</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_sys_user_group_u_attach_kb_3</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-1101443784</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>62bfcb124f3fd3400d952b8ca310c75d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af7020000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Article 3</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>c5d6d60ef7221b4054632b1f74994d0e</update_guid>
<update_guid_history>c5d6d60ef7221b4054632b1f74994d0e:-1101443784</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_section_e8d6960e13221b403527bd122244b058</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_section caption="Attach KB to Incident Notification" section_id="e8d6960e13221b403527bd122244b058" sys_domain="global" table="sys_user_group" version="3" view=""><sys_ui_element action="INSERT_OR_UPDATE"><element>u_attach_kb_enable</element><position>0</position><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:53</sys_created_on><sys_id>9ed6d60e13221b403527bd122244b0ce</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="Attach KB to Incident Notification" display_value="Attach KB to Incident Notification" name="sys_user_group" sys_domain="global" view="Default view">e8d6960e13221b403527bd122244b058</sys_ui_section><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:53</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_attach_kb_method</element><position>1</position><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:53</sys_created_on><sys_id>96d6d60e13221b403527bd122244b0cf</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="Attach KB to Incident Notification" display_value="Attach KB to Incident Notification" name="sys_user_group" sys_domain="global" view="Default view">e8d6960e13221b403527bd122244b058</sys_ui_section><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:53</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_attach_kb_1</element><position>2</position><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:53</sys_created_on><sys_id>1ad6d60e13221b403527bd122244b0cf</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="Attach KB to Incident Notification" display_value="Attach KB to Incident Notification" name="sys_user_group" sys_domain="global" view="Default view">e8d6960e13221b403527bd122244b058</sys_ui_section><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:53</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_attach_kb_2</element><position>3</position><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:53</sys_created_on><sys_id>9ad6d60e13221b403527bd122244b0cf</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="Attach KB to Incident Notification" display_value="Attach KB to Incident Notification" name="sys_user_group" sys_domain="global" view="Default view">e8d6960e13221b403527bd122244b058</sys_ui_section><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:53</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_attach_kb_3</element><position>4</position><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:53</sys_created_on><sys_id>1ed6d60e13221b403527bd122244b0cf</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="Attach KB to Incident Notification" display_value="Attach KB to Incident Notification" name="sys_user_group" sys_domain="global" view="Default view">e8d6960e13221b403527bd122244b058</sys_ui_section><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:53</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_section action="INSERT_OR_UPDATE"><caption>Attach KB to Incident Notification</caption><header>false</header><name>sys_user_group</name><roles/><sys_class_name>sys_ui_section</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_domain>global</sys_domain><sys_id>e8d6960e13221b403527bd122244b058</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Attach KB to Incident Notification</sys_name><sys_overrides/><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_section_e8d6960e13221b403527bd122244b058</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><sys_user/><title>false</title><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_section></sys_ui_section></record_update>]]></payload>
<payload_hash>-852597688</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>62bfcb124f3fd3400d952b8ca310c760</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13b0be90000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group</target_name>
<type>Form Layout</type>
<update_domain>global</update_domain>
<update_guid>96d6d60e88221b4073b2dbbf24f546d1</update_guid>
<update_guid_history>96d6d60e88221b4073b2dbbf24f546d1:-852597688</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_widget_a10631fe1316df0093625dcf3244b08c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;client_script&gt;&lt;![CDATA[function() {
  /* widget controller */
  var c = this;
	
	//function to extract fields from url
	function gup( name, url ) {
    if (!url) url = location.href;
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regexS = "[\\?&amp;]"+name+"=([^&amp;#]*)";
    var regex = new RegExp( regexS );
    var results = regex.exec( url );
    return results == null ? null : results[1];
	}
	//gup('q', 'hxxp://example.com/?q=abc')
	//alert(window.location.href)
	//alert(gup("inc", window.location.href))
	
	console.log("inc: " + gup("inc", window.location.href));
	console.log("kb: " + gup("kb", window.location.href));
	
	//onload, send id to server to resolve the inc
	c.data.inc_id = gup("inc", window.location.href);
	if (c.data.inc_id){
		c.server.update().then(function(){
			c.data.inc_id = undefined;
		});
	}
	
	//do something with the given KB too eventually
	c.data.kb = gup("kb", window.location.href);
	
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css/&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;true&lt;/has_preview&gt;&lt;id&gt;incident-close-link&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link/&gt;&lt;name&gt;Incident Close Link&lt;/name&gt;&lt;option_schema/&gt;&lt;public&gt;true&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
	
	//var temp = "27a11ce7131ad300d26f5e7f3244b0ed"; //random inc
	
	//client gave me the inc to remove
	//widget should set 
	//state -&gt; resolved (6)
	//close_code -&gt; resolved by caller "Resolved by Caller"
	//add comment "resolved by caller"
	
	if (input &amp;&amp; input.inc_id){
		var gr = new GlideRecord("incident");
		gr.addQuery("sys_id", input.inc_id);
		//gr.addQuery("sys_id", temp);
		gr.query();
		
		if (gr.next()){
			if (gr.state == 6 &amp;&amp; gr.close_code == "Resolved by Caller"){
				return;
			}
			
			gr.state = 6;
			gr.close_code = "Resolved by Caller";
			gr.comments.setJournalEntry("Resolved by Caller.", "System");

			gr.update();
		}
	}
	

	//test
	/*
	var gr = new GlideRecord("incident");
	gr.addQuery("sys_id", "5440f13613529300d26f5e7f3244b071");
	gr.query()

	if (gr.next()){
		//gs.addInfoMessage(gr.state);
		gr.state = 1;
		gr.update();
	}

	//incident state codes
	//1 new
	//6 resolved
	//7 closed
	*/
	
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-29 16:25:14&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;a10631fe1316df0093625dcf3244b08c&lt;/sys_id&gt;&lt;sys_mod_count&gt;36&lt;/sys_mod_count&gt;&lt;sys_name&gt;Incident Close Link&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_a10631fe1316df0093625dcf3244b08c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-08 21:24:53&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div&gt;
&lt;!-- your widget template --&gt;
  &lt;div&gt;
    Thank you,
  &lt;/div&gt;
  &lt;div&gt;
    Your ticket has been closed.
  &lt;/div&gt;
 
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>1314774407</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>66bfcb124f3fd3400d952b8ca310c75c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e149b3240000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Incident Close Link</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>388a9a025f621b400ed9cfa346c84bcb</update_guid>
<update_guid_history>388a9a025f621b400ed9cfa346c84bcb:1314774407,3458368d3a22d700086fb186d69492f2:1737855977,ecb166c54422d7002b5f6e8c3567d06d:244790540,7ccbd12fc6dad30033859879033ebbf6:1613598326,2364852fe49ad3007e011867317a1b12:1781556162,47d309eb809ad30027ce867556a360e1:-1819011998,6292cdabd39ad300fae2a3337118ef51:-1904565963,e34e7ce7049ad300b25f08140080e5f1:-302582566,256cb4a7209ad3004c6ecc7eb8edb3fa:-166846082,7a4cb4a7d29ad3005e11f5d10bd32d54:1628175183,ed3c34a71b9ad30038daaf610dfba863:2054336,54cbbc677c9ad300e6b602d41d9bf635:188141296,2b9bf4a3529ad3009dc063a4c148140b:-1127112208,b21ab427e09ad300ac16843dbeab704e:-304914590,afcbf936d456df000864f05b5dcffa10:1243862241,969bfdb29956df006ea68e1f0da4e73c:-1154578685,f49bb9367d56df00cf28ea3105a7be2d:1405811870,c37b31b21356df00c4702f57c2030a9a:-1108135387,b82bb9b25056df00227bba2c42aef9c1:452376687,fbb871b27256df00499cff2b4025724a:349372834,5ba83d724956df0071365bf85e82f8f8:-1811038098,e15831b2b256df00ecea89e9d362235b:1090736169,444871b20056df00572b7655d0b76343:-1243757800,493839722e56df00b6c99672e9ae7eb4:635086784,af2831b28556df00ad54246593999540:821013785,9d2839726656df00554e8d6a584165ad:-98462806,9418f5327a56df00054614a847133f00:-1045176205,c7e7f9725f56df00f31725fb078d5881:2109700040,5bd7b972df56df00f4acb25d778d7b3e:-993690448,eac7f9720a56df0022051f280ac00d7a:-912124522,4ba7b972de56df006d1925ee7e2d4f37:-1868011490,8b7735329b56df002745196d9300db71:-186816256,0d677dfea716df00affd360a94e608b9:1351271116,fc373d327756df00fa2dfc4040eea6c7:-681331990,3196fd322256df00f44201aa5e4294c7:-1219586856,8f76bd327c56df00bfb915c75507ff64:-2056561234,e50631fe5816df00f282617fcdaf788d:1406429426</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_policy_action_55689e4e13221b403527bd122244b0e1</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_policy_action"><sys_ui_policy_action action="DELETE"><disabled>ignore</disabled><field>u_attach_kb_1</field><mandatory>ignore</mandatory><sys_class_name>sys_ui_policy_action</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:15:45</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>55689e4e13221b403527bd122244b0e1</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_attach_kb_1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_policy_action_55689e4e13221b403527bd122244b0e1</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:15:45</sys_updated_on><table>sys_user_group</table><ui_policy display_value="Show/hide attach kb fields">98281a4e13221b403527bd122244b0f9</ui_policy><visible>false</visible></sys_ui_policy_action></record_update>]]></payload>
<payload_hash>-1037142959</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>66bfcb124f3fd3400d952b8ca310c75f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e142e8c90000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>u_attach_kb_1</target_name>
<type>UI Policy Action</type>
<update_domain>global</update_domain>
<update_guid>80d8168e4e221b40befc6177e6b81aea</update_guid>
<update_guid_history>80d8168e4e221b40befc6177e6b81aea:-1037142959,4b681e4e09221b4011ae40ce4bcff25d:1468394053</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_script_email_1dd304d9139e5b00d26f5e7f3244b057</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_email"&gt;&lt;sys_script_email action="INSERT_OR_UPDATE"&gt;&lt;name&gt;incident_include_relevant_kb&lt;/name&gt;&lt;new_lines_to_html&gt;true&lt;/new_lines_to_html&gt;&lt;script&gt;&lt;![CDATA[//insert relevant kb articles for this new incident
(function runMailScript(current, template, email, email_action, event) {
    //check if group has attach_kb enabled
    if (!current.assignment_group.u_attach_kb_enable){
        return;
    }

    //attach_kb is enabled for the group, so write the following
    template.print("\n");
    template.print('Meanwhile, please see the following Knowledge Base articles to see if they might assist you with your inquiry:');
    template.print("\n");

    //does group have manual kb attachment tho?
    //attaching the kb articles is different if group has manual settings.
	//start table

	//css for table and button
// 	var css_str = "&lt;style&gt;table {    font-family: arial, sans-serif;    border-collapse: collapse;    width: 100%;}tr {border-bottom: 1px solid #ccc;}td, th {    text-align: left;    padding: 8px;}.myButton {	-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;	-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;	box-shadow:inset 0px 1px 0px 0px #97c4fe;	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #3d94f6), color-stop(1, #1e62d0));	background:-moz-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-webkit-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-o-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-ms-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:linear-gradient(to bottom, #3d94f6 5%, #1e62d0 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#3d94f6', endColorstr='#1e62d0',GradientType=0);	background-color:#3d94f6;	-moz-border-radius:6px;	-webkit-border-radius:6px;	border-radius:6px;	border:1px solid #337fed;	display:inline-block;	cursor:pointer;	color:#ffffff;	font-family:Arial;	font-size:15px;	font-weight:bold;	padding:6px 24px;	text-decoration:none;	text-shadow:0px 1px 0px #1570cd;}.myButton:hover {	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #1e62d0), color-stop(1, #3d94f6));	background:-moz-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-webkit-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-o-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-ms-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:linear-gradient(to bottom, #1e62d0 5%, #3d94f6 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#1e62d0', endColorstr='#3d94f6',GradientType=0);	background-color:#1e62d0;}.myButton:active {	position:relative;	top:1px;}&lt;/style&gt;";
	var css_str = "&lt;style&gt;table {    font-family: arial, sans-serif;    border-collapse: collapse;    width: 100%;}tr {border-bottom: 1px solid #ccc;}td, th {    text-align: left;    padding: 8px;}.myButton {		-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;	-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;	background-color:#3d94f6;	-moz-border-radius:6px;	-webkit-border-radius:6px;	border-radius:6px;	border:1px solid #337fed;	display:inline-block;	cursor:pointer;	color:#ffffff;	font-family:Arial;	font-size:12px;	/* font-weight:bold; */	padding:3px 10px;	text-decoration:none;	text-shadow:0px 1px 0px #1570cd;}.myButton:hover {	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #1e62d0), color-stop(1, #3d94f6));	background:-moz-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-webkit-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-o-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-ms-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:linear-gradient(to bottom, #1e62d0 5%, #3d94f6 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#1e62d0', endColorstr='#3d94f6',GradientType=0);	background-color:#1e62d0;}.myButton:active {	position:relative;	top:1px;}&lt;/style&gt;";
	template.print(css_str);

	//start table
	template.print("&lt;table&gt;");
    if (current.assignment_group.u_attach_kb_method == "Manual"){
        var v1 = current.assignment_group.u_attach_kb_1;
        var v2 = current.assignment_group.u_attach_kb_2;
        var v3 = current.assignment_group.u_attach_kb_3;

		//this func also writes additional articles if &lt; 3 are provided
        writeKb(v1, v2, v3);
    } else {
        //attach 3 kbs that match the search based on short desc
        writeKbMultiple(3);
    }
	template.print("&lt;/table&gt;");
	//end table

	/*
    //write the rest of the msg
    template.print("\n");
    template.print("\n");
    template.print('If the KB articles solved your inquiry, please click the link below to close your ticket.');

    //add link to widget that closes the incident

    template.print("\n");
    var widget_with_inc = "url_to_widget/?inc=" + current.sys_id;
    template.print('&lt;a href=' + widget_with_inc  + ' target="_blank"&gt;Click here to close your incident.&lt;/a&gt;');
	*/

})(current, template, email, email_action, event);

// Variables accessible from script:
// current: Current GlideRecord
// template: Handles printing to the email message
// email: EmailOutbound object (null when called from Client Template)
// email_action: GlideRecord for the email notification (null when called from Client Template)
// event: GlideRecord for the event that fired the notification (null when called from Client Template)


function writeKb(v1, v2, v3){
    //count of how many kb's we need to query
	var count = 0;

	//check if [1, 3] kb is provided
	if (!v1) count++;
	if (!v2) count++;
	if (!v3) count++;

	//dynamically write 3, if mode is manual but 0 kbs are provided
	if (count == 3) {
		writeKbMultiple(count);
	}
	else {
		writeKbMixed(count, v1, v2, v3);
	}
}


function writeKbMixed(count, v1, v2, v3){
	var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
	var widget_base = "sp?id=incident_close_link&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var kbase = '7c2d56f42bd89200e0b209d417da153e'; // IT - Public

	var query = "";
    query += 'kb_knowledge_base=' + kbase;
    query += '^123TEXTQUERY321=' + current.short_description;

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count);
    kbArt.addEncodedQuery(query);
    kbArt.addQuery('kb_knowledge_base', kbase);
    kbArt.addQuery('workflow_state','published');
    kbArt.query();

    //if kb is provided, write that one
	if (v1){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v1.sys_id + ' target="_blank"&gt;' + v1.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	}
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		}
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

	//if kb is provided, write that one
	if (v2){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v2.sys_id + ' target="_blank"&gt;' + v2.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	}
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		}
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

    //if kb is provided, write that one
	if (v3){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v3.sys_id + ' target="_blank"&gt;' + v3.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	}
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		}
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

}


function writeKbMultiple(count) {
    var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
    var widget_base = "sp?id=incident_close_link&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var kbase = '7c2d56f42bd89200e0b209d417da153e'; // IT - Public

    var query = "";
    query += 'kb_knowledge_base=' + kbase;
    query += '^123TEXTQUERY321=' + current.short_description;

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count);
    kbArt.addEncodedQuery(query);
    kbArt.addQuery('kb_knowledge_base', kbase);
    kbArt.addQuery('workflow_state', 'published');
    kbArt.query();

    //it's possible we don't get 3 articles back.
    //then just write as many as we get
    while (kbArt.next()) {
        //gs.log(kbArt.number + " " + kbArt.short_description);
        template.print("&lt;tr&gt;");
        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		//button
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
        template.print("&lt;/tr&gt;");
    }
}
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_email&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-24 16:16:20&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_id&gt;&lt;sys_mod_count&gt;52&lt;/sys_mod_count&gt;&lt;sys_name&gt;incident_include_relevant_kb&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_email_1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-08 21:45:58&lt;/sys_updated_on&gt;&lt;/sys_script_email&gt;&lt;/record_update&gt;</payload>
<payload_hash>-718301875</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>6abfcb124f3fd3400d952b8ca310c75e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e15d00730000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>incident_include_relevant_kb</target_name>
<type>Email Script</type>
<update_domain>global</update_domain>
<update_guid>a15fd20602621b405ba2dcde41c81fd7</update_guid>
<update_guid_history>a15fd20602621b405ba2dcde41c81fd7:-718301875,20be56c2ee621b409574d180ced165be:1272403919,18ed1dafd7dad3009c06ba29d96ecf28:889957367,af7d95afacdad300f63cb9be97546207:-1083534923,984d15affcdad300a0b45d82c3ebcd23:-1174782924,97cc996f76dad30045aa497285476d2e:-1927758944,f93b19eb77dad300cb19a6260edc822e:-2140074465,4298156ba4dad3009f77094059d347f7:794175821,8b51952731dad300d1a82f5df68da175:-426053895,4c4f05a3eedad3007ee3610b4c94df5e:794175821,bd6305ebef9ad30085cdeeff6d36f129:-536487651,4ba1cd2bef9ad3001393edc890fb1ea5:2092245381,0b47e827a15ad3008658df05b6deff33:226830873,59e56827955ad3004d0427e3221b4c4b:-746666249,80e5e8276a5ad300319b0f5af3c879e2:1650496228,4165ace3755ad3001926723ec99368f8:282954009,8fb4e0279e5ad30036e81ffa1a1e5258:653214181,c31420e38a5ad30041c31da96c5f9f68:-1735407054,f192ac63505ad3000812b60fefea4cdb:1741323955,ed9198e7391ad300d99133818b271d23:2024030483,e4684f3eaf1693002019808e04d2c6f3:1393366783,08644bbab116930080271ee01e92f1e7:-339299198,afb3c3babf16930070d18ae6e8cc4e7a:1411950891,71a34b3a7f16930054f8924d5b96197c:129615693,00f0433a4316930064abfc8ebb5d9823:-144072004,0dcabe368a169300853ddef7d1db2fe6:1288834507,336a3a360c169300ec1f5a4937195df8:-161266019,f469feb26616930082b811c910811903:-708362339,9f187e72dc169300dfe3c70f986f77bd:-333097782,b6573efebdd2930095289652f56465c8:-864184942,93753efec4d29300b522b1be373b54c2:959388866,a7c47e7e37d2930059ceaa1e21cfe5ef:-554236393,5e9aa6f6f1d29300da8eb275501c6a29:-2058353522,c1496e369bd293000e6c5abeeaa50733:-1095736062,1c20ae7aa956df00bcf89b92e10e0ae5:-643951813,6e6f5e3e4d56df00a0c03e934a1a822f:-527518582,6c9edaba9896df006b5910bc745cfa3c:778447343,26e082b60256df00143fc38799e428ad:-1062469659,eb39b9b2ad56df006f79632251155dc8:2024427394,881f491552529b0033d6c29387d4bf0f:2032238305,0a5e011181529b000fdde17eef3def83:-1075160591,ea18415153529b0064eab1de491bc621:-6890014,bdf7c59d01129b001423e7aaea248aac:-1434059075,5ad5c59d60129b0047432bda3e95bef4:1253601649,bbb37455ac129b00faa8d17c179858cf:-1992214228,7232345545129b00fb65ce7a0a703fa1:496527116,9bbda051c2129b007e1a6d2985d78db5:1781045456,de4ae419f3de5b008b555d6c79a54fe3:-723601656,4203ac1d3ede5b006618d823ab617896:1908294079,5a495895b6de5b0044f5380ff50c7e5f:-1371753776,85f6d8d15dde5b0008c176d65da616d5:45003350,165604d9209e5b00d31ee8dab18f21fa:648340869,aa04c8d9f69e5b00afe4dd51aa150b8e:-667673171</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_documentation_sys_user_group_u_attach_kb_2_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_attach_kb_2" label="Article 2" language="en" table="sys_user_group"><sys_documentation action="INSERT_OR_UPDATE"><element>u_attach_kb_2</element><help/><hint/><label>Article 2</label><language>en</language><name>sys_user_group</name><plural>Article 2s</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>b4d6960e13221b403527bd122244b0d8</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Article 2</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_sys_user_group_u_attach_kb_2_en</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>2031348293</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>6ebfcb124f3fd3400d952b8ca310c75d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af7810000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Article 2</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>8dd6d60ed4221b40da02e1148df06414</update_guid>
<update_guid_history>8dd6d60ed4221b40da02e1148df06414:2031348293</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_policy_98281a4e13221b403527bd122244b0f9</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_ui_policy"&gt;&lt;sys_ui_policy action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;conditions table="sys_user_group"&gt;u_attach_kb_enable=false^EQ&lt;item endquery="false" field="u_attach_kb_enable" goto="false" newquery="false" operator="=" or="false" value="false"/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/conditions&gt;&lt;description/&gt;&lt;global&gt;true&lt;/global&gt;&lt;inherit&gt;false&lt;/inherit&gt;&lt;model_id/&gt;&lt;model_table/&gt;&lt;on_load&gt;true&lt;/on_load&gt;&lt;order&gt;100&lt;/order&gt;&lt;reverse_if_false&gt;true&lt;/reverse_if_false&gt;&lt;run_scripts&gt;false&lt;/run_scripts&gt;&lt;script_false&gt;&lt;![CDATA[function onCondition() {

}]]&gt;&lt;/script_false&gt;&lt;script_true&gt;&lt;![CDATA[function onCondition() {

}]]&gt;&lt;/script_true&gt;&lt;set_values/&gt;&lt;short_description&gt;Show/hide attach kb method&lt;/short_description&gt;&lt;sys_class_name&gt;sys_ui_policy&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-06-08 21:14:55&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_id&gt;98281a4e13221b403527bd122244b0f9&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;Show/hide attach kb method&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_policy_98281a4e13221b403527bd122244b0f9&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-08 21:17:38&lt;/sys_updated_on&gt;&lt;table&gt;sys_user_group&lt;/table&gt;&lt;ui_type&gt;0&lt;/ui_type&gt;&lt;view/&gt;&lt;/sys_ui_policy&gt;&lt;/record_update&gt;</payload>
<payload_hash>-534269996</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>a2bfcb124f3fd3400d952b8ca310c75f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e1430eb60000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Show/hide attach kb method</target_name>
<type>UI Policy</type>
<update_domain>global</update_domain>
<update_guid>aed8968e5e221b40feb1f241130e2c14</update_guid>
<update_guid_history>aed8968e5e221b40feb1f241130e2c14:-534269996,3238da4e45221b40a9f6be98effee790:-1724950828</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_documentation_sys_user_group_u_attach_kb_method_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_attach_kb_method" label="Attachment method" language="en" table="sys_user_group"><sys_documentation action="INSERT_OR_UPDATE"><element>u_attach_kb_method</element><help/><hint/><label>Attachment method</label><language>en</language><name>sys_user_group</name><plural>Attachment methods</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>34d6960e13221b403527bd122244b0d6</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Attachment method</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_sys_user_group_u_attach_kb_method_en</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>507385111</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>a6bfcb124f3fd3400d952b8ca310c75e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af7420000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Attachment method</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>89d6d60e34221b40983377b4be8d1711</update_guid>
<update_guid_history>89d6d60e34221b40983377b4be8d1711:507385111</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_documentation_sys_user_group_u_attach_kb_1_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_attach_kb_1" label="Article 1" language="en" table="sys_user_group"><sys_documentation action="INSERT_OR_UPDATE"><element>u_attach_kb_1</element><help/><hint/><label>Article 1</label><language>en</language><name>sys_user_group</name><plural>Article 1s</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>38d6960e13221b403527bd122244b0da</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Article 1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_sys_user_group_u_attach_kb_1_en</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>148203753</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>aabfcb124f3fd3400d952b8ca310c75d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af7640000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Article 1</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>05d6d60eaa221b40fd7ae419ba8dc713</update_guid>
<update_guid_history>05d6d60eaa221b40fd7ae419ba8dc713:148203753</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_dictionary_sys_user_group_u_attach_kb_2</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_attach_kb_2" table="sys_user_group"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Article 2</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_attach_kb_2</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>sys_user_group</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="" name="kb_knowledge">kb_knowledge</reference><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>f4d6960e13221b403527bd122244b0d7</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Article 2</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_sys_user_group_u_attach_kb_2</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>1553040022</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>aebfcb124f3fd3400d952b8ca310c75c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af6b60000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Article 2</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>49d6d60e90221b40741f2032d4fc970c</update_guid>
<update_guid_history>49d6d60e90221b40741f2032d4fc970c:1553040022</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_policy_action_f8481e4e13221b403527bd122244b03c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_policy_action"><sys_ui_policy_action action="INSERT_OR_UPDATE"><disabled>ignore</disabled><field>u_attach_kb_method</field><mandatory>ignore</mandatory><sys_class_name>sys_ui_policy_action</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:15:29</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>f8481e4e13221b403527bd122244b03c</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_attach_kb_method</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_policy_action_f8481e4e13221b403527bd122244b03c</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:15:29</sys_updated_on><table>sys_user_group</table><ui_policy display_value="Show/hide attach kb fields">98281a4e13221b403527bd122244b0f9</ui_policy><visible>false</visible></sys_ui_policy_action></record_update>]]></payload>
<payload_hash>-1394827913</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>aebfcb124f3fd3400d952b8ca310c75f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e14115ea0000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>u_attach_kb_method</target_name>
<type>UI Policy Action</type>
<update_domain>global</update_domain>
<update_guid>36585e4ed2221b40fd93b3cfbef2878e</update_guid>
<update_guid_history>36585e4ed2221b40fd93b3cfbef2878e:-1394827913</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_documentation_sys_user_group_u_attach_kb_enable_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_attach_kb_enable" label="Enable KB attachment?" language="en" table="sys_user_group"><sys_documentation action="INSERT_OR_UPDATE"><element>u_attach_kb_enable</element><help/><hint/><label>Enable KB attachment?</label><language>en</language><name>sys_user_group</name><plural>Enable KB attachment?s</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>b0d6960e13221b403527bd122244b0d4</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Enable KB attachment?</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_sys_user_group_u_attach_kb_enable_en</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<payload_hash>-929508265</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>e2bfcb124f3fd3400d952b8ca310c75e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af7250000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Enable KB attachment?</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_guid>01d6d60e7b221b4070e2c669681cb810</update_guid>
<update_guid_history>01d6d60e7b221b4070e2c669681cb810:-929508265</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_dictionary_sys_user_group_u_attach_kb_method</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_attach_kb_method" table="sys_user_group"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes>edge_encryption_enabled=true</attributes><audit>false</audit><calculation/><choice>3</choice><choice_field/><choice_table/><column_label>Attachment method</column_label><comments/><create_roles/><default_value>Automatic</default_value><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_attach_kb_method</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="String">string</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>sys_user_group</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>74d6960e13221b403527bd122244b0d5</sys_id><sys_mod_count>2</sys_mod_count><sys_name>Attachment method</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_sys_user_group_u_attach_kb_method</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:10:07</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-1491327007</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>e6bfcb124f3fd3400d952b8ca310c75d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13c2e370000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Attachment method</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>e4279e0e8c221b401da98f841f66b9fd</update_guid>
<update_guid_history>e4279e0e8c221b401da98f841f66b9fd:-1491327007,d2d6d60e98221b4004c749eceb05c4c7:666691107,89d6d60e35221b4030b4aaeb65104408:824659400</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_dictionary_sys_user_group_u_attach_kb_1</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_attach_kb_1" table="sys_user_group"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Article 1</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_attach_kb_1</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>sys_user_group</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="" name="kb_knowledge">kb_knowledge</reference><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>78d6960e13221b403527bd122244b0d9</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Article 1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_sys_user_group_u_attach_kb_1</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:08:46</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-87443468</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>eabfcb124f3fd3400d952b8ca310c75c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e13af66a0000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Article 1</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>c9d6d60ea8221b403ab2ac3f78e4d40a</update_guid>
<update_guid_history>c9d6d60ea8221b403ab2ac3f78e4d40a:-87443468</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>DELETE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_policy_action_ec88928e13221b403527bd122244b03c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_policy_action"><sys_ui_policy_action action="DELETE"><disabled>ignore</disabled><field>u_attach_kb_3</field><mandatory>ignore</mandatory><sys_class_name>sys_ui_policy_action</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:16:12</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>ec88928e13221b403527bd122244b03c</sys_id><sys_mod_count>1</sys_mod_count><sys_name>u_attach_kb_3</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_policy_action_ec88928e13221b403527bd122244b03c</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-06-08 21:16:20</sys_updated_on><table>sys_user_group</table><ui_policy display_value="Show/hide attach kb fields">98281a4e13221b403527bd122244b0f9</ui_policy><visible>false</visible></sys_ui_policy_action></record_update>]]></payload>
<payload_hash>1148637329</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>eabfcb124f3fd3400d952b8ca310c75f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e142e92e0000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>u_attach_kb_3</target_name>
<type>UI Policy Action</type>
<update_domain>global</update_domain>
<update_guid>ccd8968ec1221b4016c965b431c2d27f</update_guid>
<update_guid_history>ccd8968ec1221b4016c965b431c2d27f:1148637329,df88928e4d221b4001e3d0861d02a6e6:-640792955,61889e4e57221b405040f98064889d7e:262265374</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_policy_1409168e13221b403527bd122244b0a3</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_ui_policy"&gt;&lt;sys_ui_policy action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;conditions table="sys_user_group"&gt;u_attach_kb_enable=true^u_attach_kb_method=Manual^EQ&lt;item endquery="false" field="u_attach_kb_enable" goto="false" newquery="false" operator="=" or="false" value="true"/&gt;&lt;item endquery="false" field="u_attach_kb_method" goto="false" newquery="false" operator="=" or="false" value="Manual"/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/conditions&gt;&lt;description/&gt;&lt;global&gt;true&lt;/global&gt;&lt;inherit&gt;false&lt;/inherit&gt;&lt;model_id/&gt;&lt;model_table/&gt;&lt;on_load&gt;true&lt;/on_load&gt;&lt;order&gt;100&lt;/order&gt;&lt;reverse_if_false&gt;true&lt;/reverse_if_false&gt;&lt;run_scripts&gt;true&lt;/run_scripts&gt;&lt;script_false&gt;&lt;![CDATA[function onCondition() {
	g_form.setDisplay("u_attach_kb_1", false);
	g_form.setDisplay("u_attach_kb_2", false);
	g_form.setDisplay("u_attach_kb_3", false);
}]]&gt;&lt;/script_false&gt;&lt;script_true&gt;&lt;![CDATA[function onCondition() {
	g_form.setDisplay("u_attach_kb_1", true);
	g_form.setDisplay("u_attach_kb_2", true);
	g_form.setDisplay("u_attach_kb_3", true);
}]]&gt;&lt;/script_true&gt;&lt;set_values/&gt;&lt;short_description&gt;Show/hide attach kb articles&lt;/short_description&gt;&lt;sys_class_name&gt;sys_ui_policy&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-06-08 21:18:26&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_id&gt;1409168e13221b403527bd122244b0a3&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;Show/hide attach kb articles&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_policy_1409168e13221b403527bd122244b0a3&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-08 21:20:47&lt;/sys_updated_on&gt;&lt;table&gt;sys_user_group&lt;/table&gt;&lt;ui_type&gt;0&lt;/ui_type&gt;&lt;view/&gt;&lt;/sys_ui_policy&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1314364421</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails 2">a2bfcb124f3fd3400d952b8ca310c75c</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>eebfcb124f3fd3400d952b8ca310c75e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>163e145f0d10000001</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Show/hide attach kb articles</target_name>
<type>UI Policy</type>
<update_domain>global</update_domain>
<update_guid>6c995e8e1a221b405fe9af341c63927f</update_guid>
<update_guid_history>6c995e8e1a221b405fe9af341c63927f:-1314364421,1e095a8ec8221b405543f491c7d3818e:1494593944</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_dictionary_sys_user_group_u_attach_kb_3</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_attach_kb_3" table="sys_user_group"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice/><choice_field/><choice_table/><column_label>Article 3</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_attach_kb_3</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>sys_user_group</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="" name="kb_knowledge">kb_knowledge</reference><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual>roles=public^kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e^EQ</reference_qual><reference_qual_condition table="kb_knowledge">roles=public^kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e^EQ<item endquery="false" field="roles" goto="false" newquery="false" operator="=" or="false" value="public"/><item display_table="kb_knowledge_base" display_value="IT - Public" endquery="false" field="kb_knowledge_base" goto="false" newquery="false" operator="=" or="false" value="7c2d56f42bd89200e0b209d417da153e"/><item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/></reference_qual_condition><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>bcd6960e13221b403527bd122244b0d0</sys_id><sys_mod_count>3</sys_mod_count><sys_name>Article 3</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_sys_user_group_u_attach_kb_3</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-07-03 18:31:09</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-381927070</payload_hash>
<remote_update_set display_value="IET STRY0051388 enhancemnet - incident emails 3">a6bfcb124f3fd3400d952b8ca310c760</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>2abfcb124f3fd3400d952b8ca310c761</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461e28ad00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Article 3</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>67726eca8f835300c35bf3140dd69550</update_guid>
<update_guid_history>67726eca8f835300c35bf3140dd69550:-381927070,0a905e0a4e435300b7e5158039b2e9ad:-1285760817,68c786c293435300b01833fffe7c2de0:889936678,c5d6d60ef7221b4054632b1f74994d0e:-1101443784</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sysevent_register_31fcb1f9130b13003527bd122244b0bf</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sysevent_register"><sysevent_register action="INSERT_OR_UPDATE"><description/><event_name>incident.closed_by_kb</event_name><fired_by/><queue/><suffix/><sys_class_name>sysevent_register</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-07-02 21:09:30</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>31fcb1f9130b13003527bd122244b0bf</sys_id><sys_mod_count>0</sys_mod_count><sys_name>incident.closed_by_kb</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sysevent_register_31fcb1f9130b13003527bd122244b0bf</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-07-02 21:09:30</sys_updated_on><table/></sysevent_register></record_update>]]></payload>
<payload_hash>-1861590119</payload_hash>
<remote_update_set display_value="IET STRY0051388 enhancemnet - incident emails 3">a6bfcb124f3fd3400d952b8ca310c760</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>2ebfcb124f3fd3400d952b8ca310c760</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461e28ad00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>incident.closed_by_kb</target_name>
<type>Event Registration</type>
<update_domain>global</update_domain>
<update_guid>592d35f9500b1300bcf9ee12cef4ba11</update_guid>
<update_guid_history>592d35f9500b1300bcf9ee12cef4ba11:-1861590119</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_dictionary_sys_user_group_u_attach_kb_2</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_attach_kb_2" table="sys_user_group"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice/><choice_field/><choice_table/><column_label>Article 2</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_attach_kb_2</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>sys_user_group</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="" name="kb_knowledge">kb_knowledge</reference><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual>roles=public^kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e^EQ</reference_qual><reference_qual_condition table="kb_knowledge">roles=public^kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e^EQ<item endquery="false" field="roles" goto="false" newquery="false" operator="=" or="false" value="public"/><item display_table="kb_knowledge_base" display_value="IT - Public" endquery="false" field="kb_knowledge_base" goto="false" newquery="false" operator="=" or="false" value="7c2d56f42bd89200e0b209d417da153e"/><item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/></reference_qual_condition><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>f4d6960e13221b403527bd122244b0d7</sys_id><sys_mod_count>3</sys_mod_count><sys_name>Article 2</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_sys_user_group_u_attach_kb_2</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-07-03 18:30:53</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>947185250</payload_hash>
<remote_update_set display_value="IET STRY0051388 enhancemnet - incident emails 3">a6bfcb124f3fd3400d952b8ca310c760</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>66bfcb124f3fd3400d952b8ca310c761</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461e28ad00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Article 2</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>b362eeca10835300f2a464c6926806a9</update_guid>
<update_guid_history>b362eeca10835300f2a464c6926806a9:947185250,be805e0ac6435300e963fe3953a195a5:1323190833,2cb74e8202435300dd9f0023836f5f20:1581012616,49d6d60e90221b40741f2032d4fc970c:1553040022</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sp_widget_a10631fe1316df0093625dcf3244b08c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;client_script&gt;&lt;![CDATA[function(spUtil) {
    /* widget controller */
    var c = this;

    //function to extract fields from url
    function gup(name, url) {
        if (!url) url = location.href;
        name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
        var regexS = "[\\?&amp;]" + name + "=([^&amp;#]*)";
        var regex = new RegExp(regexS);
        var results = regex.exec(url);
        return results == null ? null : results[1];
    }

    //onload, get inc id, kb id, and inc_num from url
    c.data.inc_id = gup("inc", window.location.href);
    c.data.kb_id = gup("kb", window.location.href);
		c.data.inc_num = gup("inc_num", window.location.href);

    //if we have both, call to server
    if (c.data.inc_id &amp;&amp; c.data.kb_id) {
        c.server.update().then(function() {
					c.data.inc_id = undefined;
					c.data.kb_id = undefined;
					
					spUtil.addInfoMessage("Thank you, your ticket (" + c.data.inc_num + ") has been closed.");
					//spUtil.addInfoMessage("Thank you, your ticket has been closed.");
				});

        /*	
        var requestBody = "";

        var client = new XMLHttpRequest();
        client.open("get", "https://ucdavisietdev.service-now.com/api/uocd2/incident_close/" + inc_id + "/" + kb_id);

        client.setRequestHeader('Accept', 'application/json');
        client.setRequestHeader('Content-Type', 'application/json');

        //this user is created for us to authenticate Rest API
        client.setRequestHeader('Authorization', 'Basic ' + btoa('WebServicesUser' + ':' + 'TU2qXM6ktn28RtWF'));

        client.onreadystatechange = function() {
            if (this.readyState == this.DONE) {
                //console.log(this.status + this.response);

                status = this.status;

                //response is in string, so turn it into JSON
                //root is "result"
                var response = JSON.parse(this.response);
                console.log(response);
                var inc_num = response.result.inc_num;
                var msg = response.result.msg;

                spUtil.addInfoMessage("Thank you, your ticket (" + inc_num + ") has been closed.");
            }
        };

        client.send(requestBody);
        */
    }
}
]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css/&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;true&lt;/has_preview&gt;&lt;id&gt;incident-close-link&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link/&gt;&lt;name&gt;Incident Close Link&lt;/name&gt;&lt;option_schema/&gt;&lt;public&gt;true&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {	

	if (input &amp;&amp; input.inc_id &amp;&amp; input.kb_id){
		gs.eventQueue("incident.closed_by_kb", current, input.inc_id, input.kb_id);
	}
	
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-29 16:25:14&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;a10631fe1316df0093625dcf3244b08c&lt;/sys_id&gt;&lt;sys_mod_count&gt;136&lt;/sys_mod_count&gt;&lt;sys_name&gt;Incident Close Link&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_a10631fe1316df0093625dcf3244b08c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-07-03 16:28:09&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div&gt;
  &lt;!-- your widget template --&gt;
&lt;/div&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<payload_hash>1420370205</payload_hash>
<remote_update_set display_value="IET STRY0051388 enhancemnet - incident emails 3">a6bfcb124f3fd3400d952b8ca310c760</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>6abfcb124f3fd3400d952b8ca310c760</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461e28ad00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>incident.closed_by_kb</table>
<target_name>Incident Close Link</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_guid>3d560602db4353000b81b45076bac53a</update_guid>
<update_guid_history>3d560602db4353000b81b45076bac53a:1420370205,70895a7d484b1300f7954f2cd4b04406:-1102475065,bdf81a3d2c4b13002ab39774e3baf39e:-1976555856,6a7716f9344b1300b7f80377b6e26c2c:-1845028134,e80612392f4b1300bbd8b733105a8f59:458139460,fb859ef58e4b130094416127bd9d3fa2:-846905475,09c316f57b4b1300de280cf0d454cb96:-1494951128,0b835639234b1300694ce4bb22b872fa:1445000949,e9131679a44b1300f53a6250256a718e:301930784,764152f5a64b130039ca21c6d70fb56a:31621081,f8315639c54b13007a9dea5dd17eb2f2:-2095463172,aca016f5e54b13004e2747ec464f8db8:-577428608,3b8096f52f4b13006be98b7c1448e765:777230636,b05056b54a4b1300851bc6781c471087:737734499,cd5f86f50a4b1300af778e532af6d75c:-985423633,ea8e35f94d0b1300ae27ca559788af1a:3604735,491cb9b9b70b1300698bf15a74b6b597:-1517348933,1afb7939fe0b1300145e3e05cc758a41:620925846,85abb5b93a0b13008a4d9d8dbe9b0fb4:-1629864076,6f2bf1b98a0b1300be36719be9868b2a:-1254364175,4b99b579eb0b13007ae61330258794f9:511577914,b189b579fa0b130036228c5844348e19:-649002859,b859f1397a0b130024b6d2dcc68c0183:-1921576873,28393939590b1300e27888c45f0b82d9:-1506438513,5a19fd393c0b13006aa5af48ef775e93:-2133031075,d919b9395f0b13007a7d52cf5245555a:439053757,bf68b575cb0b13004d640e073d3ca291:1408934425,5d48f139800b13008d0bb052d5f8d4b2:-1457857873,6b87bdf5ea0b1300cc2c495864d3bc3f:843480074,db77b9f52e0b130040731f07a1638b57:1501099344,9077f535660b130030a9dfe2b753b7c4:-1724631128,356635f5060b13000ed0b54281063668:1616856578,04bb51b585c713005044b19bd66aec9f:-80523819,bc71d9f90d871300c43c5fc03511100f:-2080259339,3e5159f92987130070fcc3d390bbefb3:-1959849489,497f49b97f8713001edb4600e3f025d7:-2080259339,8dbd8179f8871300e14e64ff407999d5:-486462289,d93a41754d871300220c4e5caa751615:1477759783,6a698935be87130065628debb14ab5e7:1158879239,405945f18c87130052e079b24e6e087e:1219887989,5b978db1cb8713006ef3ae41ca448894:1465916281,4a17cd7161871300ca560e8671e6cb88:436779777,ccd645b19b87130068c042e608154d30:-1407116116,8cb605b1ee8713007250084658b7d4f6:-1781170969,24660d719b8713005a078fec93c1d57a:-1879315654,f536cd71c08713002a54ba214f469680:-1248322564,f916cd7177871300007e84ebb94d1015:-996192127,31e54d31238713009ac3998f63ef15e0:731231392,26b5c971258713004a89f11887c5f88f:-381425960,ab958971e18713000da62af30d9adae6:132599120,6925c571248713002b7a500e0b5ddaa7:-1332249934,8d834931ff871300fc7a02672a833e6a:-817126080,da738131ea871300b0ff3e6263d5fad7:183447997,bd0289fd70471300b2a2c67ccc425553:-100938381,d3291552fcb2db4064579d224753e7d4:-643577401,3a48511214b2db406f4f6551c6a5307c:-53470841,8655d9de8272db4045a395ac8e8a7483:-1332219562,f4455ddef972db40cd71a7a991f9bf1b:23869032,2315d9deb572db401e3a00683081f541:770511766,4e151dde1972db406fef09f3c76dc323:-541684485,da0519de1872db40d30daedbb363fafb:-1278735037,4ff41dde7472db40734dac8f91e4471c:-959306622,e9e4d5de6672db4031f23307336fb969:-1107515906,749451de6d72db40eeaa1d0141852ce2:-768827408,9f6495de4572db40054870fdd38cc6df:-1910802865,a15495dece72db409afba939c0ba1330:-1572316039,79e3dd9e3272db40488f7361014310a7:2048328630,9e7311debb72db40cb3cfdf1f94cb705:9507030,27f0d91ed272db40f5a41ba4bb416acb:-2063895740,6680111e0272db40f6b10fb664f7b2ab:-2033759588,1940191e4172db40244c8deca29fbe61:1592097301,697f8ddaae72db40ead6c4114cd7d2a5:-2063895740,573f89da2972db406c8f54a114a6e458:1354978836,9c8ec55a5672db409056318b8bbda735:469701850,5c5e4d1ab372db4031793b84a49be2d6:-567779131,5ddd0d1a7f72db400689f95c262bf41a:1491151035,abcd015ae572db40ee76ad0be387b508:-1396892183,d7bd4d1a5072db404ef21615679d3809:1491151035,75cc8996ac72db40d990ec9767f16024:1745076636,ccac49964472db409d4704aa866d80f3:966702844,af4c8996a072db403edb97dd4541db53:723942172,33c39e51d2bedf40500255c82100cce1:254146920,af4a861d5f7edf4085a705ccabcfbf91:-928011762,6048c699977edf408b71cc6a6ade029b:938491812,ccb64e593a7edf4064568f46f38cb54f:-906563266,2ac50259ff7edf4074e0dbba9b051a6c:-852079009,08e44a19537edf4002e7dc7b41f5fde4:-90716788,dce30ed5f27edf405e4e8bd3ba5c1724:-57652464,9592c255227edf40f5140c407583b544:439496414,d70c79d1ef7edf40c90694ce98a8547f:1470383192,3da6b151c77edf40e5f9e586f05726a6:1736450287,ef65fd9d343edf40f1d1c152f5eb6ffa:1425166224,22b43dddcc3edf400422b589769319d9:-536378192,d4c1759d703edf40afce9ffba2e84678:55366422,22fee91d8d3edf409490a35a41dce5b5:-813008820,3e0ea11d563edf40191c712a614b27d8:1524677516,6afce959533edf4045f3d8a59a67781a:545343513,c7dce9194d3edf40b60a5ea9ceeb1162:-194719492,f44c2959123edf406ae6eb6ca40436de:1742275129,857d0995ccfadf4000c6603e5f7a0723:-693955731,388a9a025f621b400ed9cfa346c84bcb:1314774407,3458368d3a22d700086fb186d69492f2:1737855977,ecb166c54422d7002b5f6e8c3567d06d:244790540,7ccbd12fc6dad30033859879033ebbf6:1613598326,2364852fe49ad3007e011867317a1b12:1781556162,47d309eb809ad30027ce867556a360e1:-1819011998,6292cdabd39ad300fae2a3337118ef51:-1904565963,e34e7ce7049ad300b25f08140080e5f1:-302582566,256cb4a7209ad3004c6ecc7eb8edb3fa:-166846082,7a4cb4a7d29ad3005e11f5d10bd32d54:1628175183,ed3c34a71b9ad30038daaf610dfba863:2054336,54cbbc677c9ad300e6b602d41d9bf635:188141296,2b9bf4a3529ad3009dc063a4c148140b:-1127112208,b21ab427e09ad300ac16843dbeab704e:-304914590,afcbf936d456df000864f05b5dcffa10:1243862241,969bfdb29956df006ea68e1f0da4e73c:-1154578685,f49bb9367d56df00cf28ea3105a7be2d:1405811870,c37b31b21356df00c4702f57c2030a9a:-1108135387,b82bb9b25056df00227bba2c42aef9c1:452376687,fbb871b27256df00499cff2b4025724a:349372834,5ba83d724956df0071365bf85e82f8f8:-1811038098,e15831b2b256df00ecea89e9d362235b:1090736169,444871b20056df00572b7655d0b76343:-1243757800,493839722e56df00b6c99672e9ae7eb4:635086784,af2831b28556df00ad54246593999540:821013785,9d2839726656df00554e8d6a584165ad:-98462806,9418f5327a56df00054614a847133f00:-1045176205,c7e7f9725f56df00f31725fb078d5881:2109700040,5bd7b972df56df00f4acb25d778d7b3e:-993690448,eac7f9720a56df0022051f280ac00d7a:-912124522,4ba7b972de56df006d1925ee7e2d4f37:-1868011490,8b7735329b56df002745196d9300db71:-186816256,0d677dfea716df00affd360a94e608b9:1351271116,fc373d327756df00fa2dfc4040eea6c7:-681331990,3196fd322256df00f44201aa5e4294c7:-1219586856,8f76bd327c56df00bfb915c75507ff64:-2056561234,e50631fe5816df00f282617fcdaf788d:1406429426</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_dictionary_sys_user_group_u_attach_kb_1</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_attach_kb_1" table="sys_user_group"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice/><choice_field/><choice_table/><column_label>Article 1</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_attach_kb_1</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>sys_user_group</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="" name="kb_knowledge">kb_knowledge</reference><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual>roles=public^kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e^EQ</reference_qual><reference_qual_condition table="kb_knowledge">roles=public^kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e^EQ<item endquery="false" field="roles" goto="false" newquery="false" operator="=" or="false" value="public"/><item display_table="kb_knowledge_base" display_value="IT - Public" endquery="false" field="kb_knowledge_base" goto="false" newquery="false" operator="=" or="false" value="7c2d56f42bd89200e0b209d417da153e"/><item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/></reference_qual_condition><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin-nexisn4</sys_created_by><sys_created_on>2018-06-08 21:08:46</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>78d6960e13221b403527bd122244b0d9</sys_id><sys_mod_count>3</sys_mod_count><sys_name>Article 1</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_sys_user_group_u_attach_kb_1</sys_update_name><sys_updated_by>admin-nexisn4</sys_updated_by><sys_updated_on>2018-07-03 18:29:17</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<payload_hash>-2018669726</payload_hash>
<remote_update_set display_value="IET STRY0051388 enhancemnet - incident emails 3">a6bfcb124f3fd3400d952b8ca310c760</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>a2bfcb124f3fd3400d952b8ca310c761</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461e28ad00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>sys_user_group</table>
<target_name>Group.Article 1</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_guid>1c126acad9835300bff4142597f1c80b</update_guid>
<update_guid_history>1c126acad9835300bff4142597f1c80b:-2018669726,3070da0a55435300fe59caf2f86004b1:-362824813,e497c2c2bd435300ab58243258808192:-2022878742,c9d6d60ea8221b403ab2ac3f78e4d40a:-87443468</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_script_email_1dd304d9139e5b00d26f5e7f3244b057</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_email"&gt;&lt;sys_script_email action="INSERT_OR_UPDATE"&gt;&lt;name&gt;incident_include_relevant_kb&lt;/name&gt;&lt;new_lines_to_html&gt;true&lt;/new_lines_to_html&gt;&lt;script&gt;&lt;![CDATA[//insert relevant kb articles for this new incident
(function runMailScript(current, template, email, email_action, event) {
    //check if group has attach_kb enabled
    if (!current.assignment_group.u_attach_kb_enable) {
        return;
    }

    var css_str = "&lt;style&gt;table {    font-family: arial, sans-serif;    border-collapse: collapse;    width: 100%;}tr {border-bottom: 1px solid #ccc;}td, th {    text-align: left;    padding: 8px;}.myButton {		-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;	-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;	background-color:#3d94f6;	-moz-border-radius:6px;	-webkit-border-radius:6px;	border-radius:6px;	border:1px solid #337fed;	display:inline-block;	cursor:pointer;	color:#ffffff;	font-family:Arial;	font-size:12px;	/* font-weight:bold; */	padding:3px 10px;	text-decoration:none;	text-shadow:0px 1px 0px #1570cd;}.myButton:hover {	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #1e62d0), color-stop(1, #3d94f6));	background:-moz-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-webkit-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-o-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-ms-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:linear-gradient(to bottom, #1e62d0 5%, #3d94f6 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#1e62d0', endColorstr='#3d94f6',GradientType=0);	background-color:#1e62d0;}.myButton:active {	position:relative;	top:1px;}&lt;/style&gt;";
    template.print(css_str);

    //start table
    template.print("&lt;table&gt;");
    if (current.assignment_group.u_attach_kb_method == "Manual") {
        var v1 = current.assignment_group.u_attach_kb_1;
        var v2 = current.assignment_group.u_attach_kb_2;
        var v3 = current.assignment_group.u_attach_kb_3;

        //this func also writes additional articles if &lt; 3 are provided
        writeKb(v1, v2, v3);
    } else {
        //attach 3 kbs that match the search based on short desc
        writeKbMultiple(3);
    }

    template.print("&lt;/table&gt;");
    //end table
})(current, template, email, email_action, event);

// Variables accessible from script:
// current: Current GlideRecord
// template: Handles printing to the email message
// email: EmailOutbound object (null when called from Client Template)
// email_action: GlideRecord for the email notification (null when called from Client Template)
// event: GlideRecord for the event that fired the notification (null when called from Client Template)


function writeKb(v1, v2, v3) {
    //count of how many kb's we need to query
    var count = 0;

    //check if [1, 3] kb is provided
    if (!v1) count++;
    if (!v2) count++;
    if (!v3) count++;

    //dynamically write 3, if mode is manual but 0 kbs are provided
    if (count == 3) {
        writeKbMultiple(count);
    } else {
        writeKbMixed(count, v1, v2, v3);
    }
}


function writeKbMixed(count, v1, v2, v3) {
    var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
    var widget_base = "servicehub?id=incident_close_link&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var query = "";
    query += 'kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e'; // IT - Public
    query += '^roles=public'; //only show public ones so guests can see
    query += '^IR_OR_QUERY=' + current.short_description; //look for inc's short_desc
    query += '^workflow_state=published';

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count); //only need count maximum
    kbArt.addEncodedQuery(query);
    kbArt.query();

    //count    &lt; 3 means {1,2,3} articles were provided
    //rowCount &gt; 0 means {1+} articles were found
    //either case is good to display some kb articles
    if (count &lt; 3 || kbArt.getRowCount &gt; 0) {
        template.print("\n");
        template.print('Meanwhile, please see the following Knowledge Base articles to see if they might assist you with your inquiry:');
        template.print("\n");
    }

    //if kb is provided, write that one
    if (v1) {
        template.print("&lt;tr&gt;");

        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v1.sys_id + ' target="_blank"&gt;' + v1.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/td&gt;');

        //button
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + v1.sys_id + "&amp;inc_num=" + current.number;
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

        template.print("&lt;/tr&gt;");
    }
    //else, write it from the query
    else {
        //if query has a kb
        if (kbArt.next()) {
            template.print("&lt;tr&gt;");

            //kb link
            template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/td&gt;');

            //button
            var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id + "&amp;inc_num=" + current.number;
            template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

            template.print("&lt;/tr&gt;");
        }
        //else query didnt have a kb
        //dont do anything kek
    }

    if (v2) {
        template.print("&lt;tr&gt;");

        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v2.sys_id + ' target="_blank"&gt;' + v2.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/td&gt;');

        //button
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + v2.sys_id + "&amp;inc_num=" + current.number;
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

        template.print("&lt;/tr&gt;");
    }
    //else, write it from the query
    else {
        //if query has a kb
        if (kbArt.next()) {
            template.print("&lt;tr&gt;");

            //kb link
            template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/td&gt;');

            //button
            var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id + "&amp;inc_num=" + current.number;
            template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

            template.print("&lt;/tr&gt;");
        }
        //else query didnt have a kb
        //dont do anything kek
    }

    //if kb is provided, write that one
    if (v3) {
        template.print("&lt;tr&gt;");

        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v3.sys_id + ' target="_blank"&gt;' + v3.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/td&gt;');

        //button
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + v3.sys_id + "&amp;inc_num=" + current.number;
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

        template.print("&lt;/tr&gt;");
    }
    //else, write it from the query
    else {
        //if query has a kb
        if (kbArt.next()) {
            template.print("&lt;tr&gt;");

            //kb link
            template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;/td&gt;');

            //button
            var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id + "&amp;inc_num=" + current.number;
            template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

            template.print("&lt;/tr&gt;");
        }
        //else query didnt have a kb
        //dont do anything kek
    }

}


function writeKbMultiple(count) {
    var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
    var widget_base = "servicehub?id=incident_close_link&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var query = "";
    query += 'kb_knowledge_base=7c2d56f42bd89200e0b209d417da153e'; // IT - Public
    query += '^roles=public'; //only show public ones so guests can see
    query += '^IR_OR_QUERY=' + current.short_description; //look for inc's short_desc
    query += '^workflow_state=published';

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count); //only need 3 maximum
    kbArt.addEncodedQuery(query);
    kbArt.query();

    if (kbArt.getRowCount &gt; 0) {
        template.print("\n");
        template.print('Meanwhile, please see the following Knowledge Base articles to see if they might assist you with your inquiry:');
        template.print("\n");
    }

    //it's possible we don't get 3 articles back.
    //then just write as many as we get
    while (kbArt.next()) {
        template.print("&lt;tr&gt;");

        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id + "&amp;inc_num=" + current.number;

        //button
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');

        template.print("&lt;/tr&gt;");
    }
}
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_email&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-24 16:16:20&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_id&gt;&lt;sys_mod_count&gt;77&lt;/sys_mod_count&gt;&lt;sys_name&gt;incident_include_relevant_kb&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_email_1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-07-03 18:14:51&lt;/sys_updated_on&gt;&lt;/sys_script_email&gt;&lt;/record_update&gt;</payload>
<payload_hash>1542691347</payload_hash>
<remote_update_set display_value="IET STRY0051388 enhancemnet - incident emails 3">a6bfcb124f3fd3400d952b8ca310c760</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>eabfcb124f3fd3400d952b8ca310c761</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461e28ad00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>incident.closed_by_kb</table>
<target_name>incident_include_relevant_kb</target_name>
<type>Email Script</type>
<update_domain>global</update_domain>
<update_guid>b0ce5e0a318353003a8ca836a8f084b9</update_guid>
<update_guid_history>b0ce5e0a318353003a8ca836a8f084b9:1542691347,4e0d9ac230835300ff186cec33ce9e2d:707707576,4f679202028353003d63243141e32ad5:-1261772362,af725e8a7b43530023050d0a9ac107ad:-865979662,c9519e0a744353006573425eaa71f127:494305476,7465c642ef43530069e564837c73bec4:1578689896,349a8ab14e4b13009bc9d83e77abf18b:-1565510080,ed8789b1d2871300ede545f7cbfbe1a2:-1667052640,a0d36bf125b6538047958b79d0d26111:-731803741,1af0e37172b65380aadc4432690cfe8a:-82312715,eed06fb13db65380037a13ce53420461:-731803741,1bff9bb1c1b65380cdd741d401d67355:-1121188946,64fd87e1fc3e1380b50b91e01fce4528:-731803741,7a4932212afa1380e449d308e6e2d73c:-1029147077,8df52e2551ba1380305bd1bf7a32d8bb:1891044717,bfe52e253aba13807cbeb73166ddd379:-106479397,49c56e25a9ba1380529ad12d3f53f08a:1596226715,67a5aee141ba1380053fdb5f81f7072a:1752739899,37556225bfba138091abcbbfa2a68913:729397439,f814a6e122ba138010aa3376c28e6ed8:1371620317,5ba32ae1b6ba1380e00166a04942bef7:473462572,b28266a116ba138072046886103a74fa:-626877156,6f8122a1baba1380bce38d66e79e33e9:-102970522,97dc12e9c87a1380f9307ad55a84dbd9:776183103,a245f510083e97405db29c8a58715a57:-774461761,a15fd20602621b405ba2dcde41c81fd7:-718301875,20be56c2ee621b409574d180ced165be:1272403919,18ed1dafd7dad3009c06ba29d96ecf28:889957367,af7d95afacdad300f63cb9be97546207:-1083534923,984d15affcdad300a0b45d82c3ebcd23:-1174782924,97cc996f76dad30045aa497285476d2e:-1927758944,f93b19eb77dad300cb19a6260edc822e:-2140074465,4298156ba4dad3009f77094059d347f7:794175821,8b51952731dad300d1a82f5df68da175:-426053895,4c4f05a3eedad3007ee3610b4c94df5e:794175821,bd6305ebef9ad30085cdeeff6d36f129:-536487651,4ba1cd2bef9ad3001393edc890fb1ea5:2092245381,0b47e827a15ad3008658df05b6deff33:226830873,59e56827955ad3004d0427e3221b4c4b:-746666249,80e5e8276a5ad300319b0f5af3c879e2:1650496228,4165ace3755ad3001926723ec99368f8:282954009,8fb4e0279e5ad30036e81ffa1a1e5258:653214181,c31420e38a5ad30041c31da96c5f9f68:-1735407054,f192ac63505ad3000812b60fefea4cdb:1741323955,ed9198e7391ad300d99133818b271d23:2024030483,e4684f3eaf1693002019808e04d2c6f3:1393366783,08644bbab116930080271ee01e92f1e7:-339299198,afb3c3babf16930070d18ae6e8cc4e7a:1411950891,71a34b3a7f16930054f8924d5b96197c:129615693,00f0433a4316930064abfc8ebb5d9823:-144072004,0dcabe368a169300853ddef7d1db2fe6:1288834507,336a3a360c169300ec1f5a4937195df8:-161266019,f469feb26616930082b811c910811903:-708362339,9f187e72dc169300dfe3c70f986f77bd:-333097782,b6573efebdd2930095289652f56465c8:-864184942,93753efec4d29300b522b1be373b54c2:959388866,a7c47e7e37d2930059ceaa1e21cfe5ef:-554236393,5e9aa6f6f1d29300da8eb275501c6a29:-2058353522,c1496e369bd293000e6c5abeeaa50733:-1095736062,1c20ae7aa956df00bcf89b92e10e0ae5:-643951813,6e6f5e3e4d56df00a0c03e934a1a822f:-527518582,6c9edaba9896df006b5910bc745cfa3c:778447343,26e082b60256df00143fc38799e428ad:-1062469659,eb39b9b2ad56df006f79632251155dc8:2024427394,881f491552529b0033d6c29387d4bf0f:2032238305,0a5e011181529b000fdde17eef3def83:-1075160591,ea18415153529b0064eab1de491bc621:-6890014,bdf7c59d01129b001423e7aaea248aac:-1434059075,5ad5c59d60129b0047432bda3e95bef4:1253601649,bbb37455ac129b00faa8d17c179858cf:-1992214228,7232345545129b00fb65ce7a0a703fa1:496527116,9bbda051c2129b007e1a6d2985d78db5:1781045456,de4ae419f3de5b008b555d6c79a54fe3:-723601656,4203ac1d3ede5b006618d823ab617896:1908294079,5a495895b6de5b0044f5380ff50c7e5f:-1371753776,85f6d8d15dde5b0008c176d65da616d5:45003350,165604d9209e5b00d31ee8dab18f21fa:648340869,aa04c8d9f69e5b00afe4dd51aa150b8e:-667673171</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sysevent_script_action_984df579130b13003527bd122244b09a</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_script_action"&gt;&lt;sysevent_script_action action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;condition_script/&gt;&lt;description/&gt;&lt;event_name&gt;incident.closed_by_kb&lt;/event_name&gt;&lt;name&gt;Incident Closed by KB&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;script&gt;&lt;![CDATA[run();

function run() {

    //query the inc
    var gr_inc = new GlideRecord("incident");
    gr_inc.addQuery("sys_id", event.parm1); //p1 is inc_id
    gr_inc.query();

    if (gr_inc.next()) {
        //if inc is already closed/resolved
        if (gr_inc.state == 6 || gr_inc.state == 7) {
            gs.log("incident.closed_by_kb: " + gr_inc.number +" already closed/resolved");
            return;
        }

        //query the kb
        var gr_kb = new GlideRecord("kb_knowledge");
        gr_kb.addQuery("sys_id", event.parm2); //p2 is kb_id
        gr_kb.query();

        if (gr_kb.next()) {
            gr_inc.state = 7;
            gr_inc.close_code = "Closed by KB";

            var kbLink = "servicehub/?id=ucd_kb_article&amp;sys_id=" + gr_kb.sys_id;

            // journal format: "Resolved by Caller using [KB Number] - [KB Article Title]."
            var journalString =
                "[code]" +
                "Resolved by Caller using " +
                gr_kb.number +
                " - " +
                "&lt;a href=" + kbLink + "&gt;" + gr_kb.short_description + "&lt;/a&gt;" +
                "." +
                "[/code]";
            gr_inc.comments.setJournalEntry(journalString, "System");

            gr_inc.update();
            gs.log("incident.closed_by_kb: updated " + gr_inc.number);
        } //if gr_kb
        else {
            gs.log("incident.closed_by_kb: kb not found");
        }
    } //if inc
    else {
        gs.log("incident.closed_by_kb: inc not found");
    }
} //run()
]]&gt;&lt;/script&gt;&lt;synchronous&gt;false&lt;/synchronous&gt;&lt;sys_class_name&gt;sysevent_script_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-07-02 21:10:18&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_id&gt;984df579130b13003527bd122244b09a&lt;/sys_id&gt;&lt;sys_mod_count&gt;13&lt;/sys_mod_count&gt;&lt;sys_name&gt;Incident Closed by KB&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_script_action_984df579130b13003527bd122244b09a&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-nexisn4&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-07-02 23:11:15&lt;/sys_updated_on&gt;&lt;/sysevent_script_action&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1617931170</payload_hash>
<remote_update_set display_value="IET STRY0051388 enhancemnet - incident emails 3">a6bfcb124f3fd3400d952b8ca310c760</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>eebfcb124f3fd3400d952b8ca310c760</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16461e28ad00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>incident.closed_by_kb</table>
<target_name>Incident Closed by KB</target_name>
<type>Script Action</type>
<update_domain>global</update_domain>
<update_guid>7009123d074b13005e55f3367ca90b16</update_guid>
<update_guid_history>7009123d074b13005e55f3367ca90b16:-1617931170,016616f5dd4b130070d37b6c4ebee5a2:-146250583,6f6e86b5da4b13005114cb629e369cb7:-249952844,9d1e46b55f4b1300613315c966a4897e:1370266356,9e16c6317d4b130063dc4c3106f4d527:1222833744,64d5c631824b1300d3856c7f9e132d77:1022724793,58f48efd460b1300321a095f1a3f6e23:-28952838,a9f3cabd710b1300b7d2939e54251eb4:846448004,23c286bd7b0b1300e1954697a6472928:1683757428,72908e3d690b1300c8d7f677c257a700:-1941325141,b5eff179d60b1300d62454e026f637d8:-2147058981,d85f313d080b130043fbf1814857018e:599435323,7d4e75f9810b13005db497bc726120ba:1161355419,4d5d75f9530b13003d8111af6056e4b6:-504947658</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_section_7ee9e7b513b653803527bd122244b070</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_section caption="" section_id="7ee9e7b513b653803527bd122244b070" sys_domain="global" table="live_message_tag" version="3" view=""><sys_ui_element action="INSERT_OR_UPDATE"><element>.begin_split</element><position>0</position><sys_created_by>admin-damascus</sys_created_by><sys_created_on>2018-06-20 18:49:02</sys_created_on><sys_id>36e9abf513b653803527bd122244b0cd</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="live_message_tag" sys_domain="global" view="Default view">7ee9e7b513b653803527bd122244b070</sys_ui_section><sys_updated_by>admin-damascus</sys_updated_by><sys_updated_on>2018-06-20 18:49:02</sys_updated_on><sys_user/><type>.begin_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>message</element><position>1</position><sys_created_by>admin-damascus</sys_created_by><sys_created_on>2018-06-20 18:49:02</sys_created_on><sys_id>3ee9abf513b653803527bd122244b0cd</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="live_message_tag" sys_domain="global" view="Default view">7ee9e7b513b653803527bd122244b070</sys_ui_section><sys_updated_by>admin-damascus</sys_updated_by><sys_updated_on>2018-06-20 18:49:02</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>reply_to</element><position>2</position><sys_created_by>admin-damascus</sys_created_by><sys_created_on>2018-06-20 18:49:02</sys_created_on><sys_id>bee9abf513b653803527bd122244b0cd</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="live_message_tag" sys_domain="global" view="Default view">7ee9e7b513b653803527bd122244b070</sys_ui_section><sys_updated_by>admin-damascus</sys_updated_by><sys_updated_on>2018-06-20 18:49:02</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.split</element><position>3</position><sys_created_by>admin-damascus</sys_created_by><sys_created_on>2018-06-20 18:49:02</sys_created_on><sys_id>32e9abf513b653803527bd122244b0ce</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="live_message_tag" sys_domain="global" view="Default view">7ee9e7b513b653803527bd122244b070</sys_ui_section><sys_updated_by>admin-damascus</sys_updated_by><sys_updated_on>2018-06-20 18:49:02</sys_updated_on><sys_user/><type>.split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>tag</element><position>4</position><sys_created_by>admin-damascus</sys_created_by><sys_created_on>2018-06-20 18:49:02</sys_created_on><sys_id>b2e9abf513b653803527bd122244b0ce</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="live_message_tag" sys_domain="global" view="Default view">7ee9e7b513b653803527bd122244b070</sys_ui_section><sys_updated_by>admin-damascus</sys_updated_by><sys_updated_on>2018-06-20 18:49:02</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>sys_domain</element><position>5</position><sys_created_by>admin-damascus</sys_created_by><sys_created_on>2018-06-20 18:49:02</sys_created_on><sys_id>36e9abf513b653803527bd122244b0ce</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="live_message_tag" sys_domain="global" view="Default view">7ee9e7b513b653803527bd122244b070</sys_ui_section><sys_updated_by>admin-damascus</sys_updated_by><sys_updated_on>2018-06-20 18:49:02</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.end_split</element><position>6</position><sys_created_by>admin-damascus</sys_created_by><sys_created_on>2018-06-20 18:49:02</sys_created_on><sys_id>b6e9abf513b653803527bd122244b0ce</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="live_message_tag" sys_domain="global" view="Default view">7ee9e7b513b653803527bd122244b070</sys_ui_section><sys_updated_by>admin-damascus</sys_updated_by><sys_updated_on>2018-06-20 18:49:02</sys_updated_on><sys_user/><type>.end_split</type></sys_ui_element><sys_ui_section action="INSERT_OR_UPDATE"><caption/><header>false</header><name>live_message_tag</name><roles/><sys_class_name>sys_ui_section</sys_class_name><sys_created_by>admin-damascus</sys_created_by><sys_created_on>2018-06-20 18:49:02</sys_created_on><sys_customer_update>false</sys_customer_update><sys_domain>global</sys_domain><sys_id>7ee9e7b513b653803527bd122244b070</sys_id><sys_mod_count>0</sys_mod_count><sys_name>live_message_tag</sys_name><sys_overrides/><sys_package display_value="Live Feed" source="com.glideapp.live_feed">5db71e75dc323000e0b25f936628a7db</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_section_7ee9e7b513b653803527bd122244b070</sys_update_name><sys_updated_by>admin-damascus</sys_updated_by><sys_updated_on>2018-06-20 18:49:02</sys_updated_on><sys_user/><title>true</title><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_section></sys_ui_section></record_update>]]></payload>
<payload_hash>-1102883497</payload_hash>
<remote_update_set display_value="IET STRY0058349 Enhancement: KB Article in Incident email also triggers on group">e2bfcb124f3fd3400d952b8ca310c763</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>2abfcb124f3fd3400d952b8ca310c764</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641f7c01d00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>live_message_tag</table>
<target_name>Live Message Tag</target_name>
<type>Form Layout</type>
<update_domain>global</update_domain>
<update_guid>32e9abf5dcb6538062338ca62d3c31d0</update_guid>
<update_guid_history>32e9abf5dcb6538062338ca62d3c31d0:-1102883497,76e9abf555b6538031947ff687e759c9:372648490</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sysevent_email_action_8f9cea1dc0a801640185982cb7b19252</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_email_action"&gt;&lt;sysevent_email_action action="INSERT_OR_UPDATE"&gt;&lt;action_insert&gt;false&lt;/action_insert&gt;&lt;action_update&gt;true&lt;/action_update&gt;&lt;active&gt;true&lt;/active&gt;&lt;advanced_condition&gt;&lt;![CDATA[// check if group has changed
answer = !current.assignment_group.changes();]]&gt;&lt;/advanced_condition&gt;&lt;affected_field_on_event/&gt;&lt;category display_value="Incident" name="Incident"&gt;4d7f4b0713b103003527bd122244b096&lt;/category&gt;&lt;collection&gt;incident&lt;/collection&gt;&lt;condition table="incident"&gt;commentsVALCHANGES^u_emailed_fromISNOTEMPTY^u_do_not_send_notification=false^state!=7^EQ&lt;item endquery="false" field="comments" goto="false" newquery="false" operator="VALCHANGES" or="false" value=""/&gt;&lt;item endquery="false" field="u_emailed_from" goto="false" newquery="false" operator="ISNOTEMPTY" or="false" value=""/&gt;&lt;item endquery="false" field="u_do_not_send_notification" goto="false" newquery="false" operator="=" or="false" value="false"/&gt;&lt;item endquery="false" field="state" goto="false" newquery="false" operator="!=" or="false" value="7"/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/condition&gt;&lt;content_type&gt;multipart/mixed&lt;/content_type&gt;&lt;description&gt;Purpose: Sends notifications when comments added if incident's 'Emailed from' field is filled (see settings below for full conditions).&amp;#13;
&amp;#13;
Does not run if the assignment group changes: See "User: Incident commented, changed group" for that case.&amp;#13;
&amp;#13;
Does not run if 'Emailed from' field is unfilled: See "User: Incident commented not email" for that case.&lt;/description&gt;&lt;event_name&gt;incident.commented&lt;/event_name&gt;&lt;event_parm_1&gt;false&lt;/event_parm_1&gt;&lt;event_parm_2&gt;false&lt;/event_parm_2&gt;&lt;exclude_delegates&gt;false&lt;/exclude_delegates&gt;&lt;force_delivery&gt;false&lt;/force_delivery&gt;&lt;from/&gt;&lt;generation_type&gt;engine&lt;/generation_type&gt;&lt;importance/&gt;&lt;include_attachments&gt;true&lt;/include_attachments&gt;&lt;item&gt;event.parm1&lt;/item&gt;&lt;item_table/&gt;&lt;mandatory&gt;false&lt;/mandatory&gt;&lt;message/&gt;&lt;message_html/&gt;&lt;message_list/&gt;&lt;message_text/&gt;&lt;name&gt;User: Incident commented Email&lt;/name&gt;&lt;omit_watermark&gt;false&lt;/omit_watermark&gt;&lt;order&gt;100&lt;/order&gt;&lt;push_message_only&gt;false&lt;/push_message_only&gt;&lt;recipient_fields&gt;watch_list,u_emailed_from,caller_id,u_requested_for&lt;/recipient_fields&gt;&lt;recipient_groups/&gt;&lt;recipient_users/&gt;&lt;reply_to/&gt;&lt;send_self&gt;false&lt;/send_self&gt;&lt;sms_alternate/&gt;&lt;style/&gt;&lt;subject/&gt;&lt;subscribable&gt;false&lt;/subscribable&gt;&lt;sys_class_name&gt;sysevent_email_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;fred.luddy&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2004-12-01 17:10:53&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_id&gt;8f9cea1dc0a801640185982cb7b19252&lt;/sys_id&gt;&lt;sys_mod_count&gt;11&lt;/sys_mod_count&gt;&lt;sys_name&gt;User: Incident commented Email&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="System (apps/system_policy)" source="apps/system_policy"&gt;b360efb04f2112009cab76601310c7df&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_email_action_8f9cea1dc0a801640185982cb7b19252&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-bgerrity&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-19 23:15:29&lt;/sys_updated_on&gt;&lt;sys_version&gt;2&lt;/sys_version&gt;&lt;template display_value="user.incident.commented"&gt;f17e0aed13fff6403527bd122244b00a&lt;/template&gt;&lt;type&gt;email&lt;/type&gt;&lt;weight&gt;20&lt;/weight&gt;&lt;/sysevent_email_action&gt;&lt;/record_update&gt;</payload>
<payload_hash>890582205</payload_hash>
<remote_update_set display_value="IET STRY0058349 Enhancement: KB Article in Incident email also triggers on group">e2bfcb124f3fd3400d952b8ca310c763</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>2ebfcb124f3fd3400d952b8ca310c763</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641f7c01d00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>incident</table>
<target_name>User: Incident commented Email</target_name>
<type>Notification</type>
<update_domain>global</update_domain>
<update_guid>cc5d172d1a3e1380f9bc9372b370a227</update_guid>
<update_guid_history>cc5d172d1a3e1380f9bc9372b370a227:890582205,cbfc5769943e13801f7a50a53bf40682:-891889283,875c57e9193e1380ff0af50cad32f4b2:803519487,91ea57e9393e1380791c4103c0bc8564:1835258219,87c913691b3e138031c719e7d277ceb2:-1945816746,761188852:761188852,1846773823:1846773823,-1975132346:-1975132346,-841473039:-841473039,-1975132346:-1975132346,-548048817:-548048817,1565392010:1565392010,1998171258:1998171258,-1126233117:-1126233117</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_script_email_1dd304d9139e5b00d26f5e7f3244b057</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_email"&gt;&lt;sys_script_email action="INSERT_OR_UPDATE"&gt;&lt;name&gt;incident_include_relevant_kb&lt;/name&gt;&lt;new_lines_to_html&gt;true&lt;/new_lines_to_html&gt;&lt;script&gt;&lt;![CDATA[//insert relevant kb articles for this new incident
(function runMailScript(current, template, email, email_action, event) {
	
    //check if group has attach_kb enabled
    if (!current.assignment_group.u_attach_kb_enable){
        return;
    }
	
    //attach_kb is enabled for the group, so write the following
    template.print("\n");
    template.print('Meanwhile, please see the following Knowledge Base articles to see if they might assist you with your inquiry:');
    template.print("\n");

    //does group have manual kb attachment tho?
    //attaching the kb articles is different if group has manual settings.
	//start table

	//css for table and button
// 	var css_str = "&lt;style&gt;table {    font-family: arial, sans-serif;    border-collapse: collapse;    width: 100%;}tr {border-bottom: 1px solid #ccc;}td, th {    text-align: left;    padding: 8px;}.myButton {	-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;	-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;	box-shadow:inset 0px 1px 0px 0px #97c4fe;	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #3d94f6), color-stop(1, #1e62d0));	background:-moz-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-webkit-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-o-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-ms-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:linear-gradient(to bottom, #3d94f6 5%, #1e62d0 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#3d94f6', endColorstr='#1e62d0',GradientType=0);	background-color:#3d94f6;	-moz-border-radius:6px;	-webkit-border-radius:6px;	border-radius:6px;	border:1px solid #337fed;	display:inline-block;	cursor:pointer;	color:#ffffff;	font-family:Arial;	font-size:15px;	font-weight:bold;	padding:6px 24px;	text-decoration:none;	text-shadow:0px 1px 0px #1570cd;}.myButton:hover {	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #1e62d0), color-stop(1, #3d94f6));	background:-moz-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-webkit-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-o-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-ms-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:linear-gradient(to bottom, #1e62d0 5%, #3d94f6 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#1e62d0', endColorstr='#3d94f6',GradientType=0);	background-color:#1e62d0;}.myButton:active {	position:relative;	top:1px;}&lt;/style&gt;";
	var css_str = "&lt;style&gt;table {    font-family: arial, sans-serif;    border-collapse: collapse;    width: 100%;}tr {border-bottom: 1px solid #ccc;}td, th {    text-align: left;    padding: 8px;}.myButton {		-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;	-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;	background-color:#3d94f6;	-moz-border-radius:6px;	-webkit-border-radius:6px;	border-radius:6px;	border:1px solid #337fed;	display:inline-block;	cursor:pointer;	color:#ffffff;	font-family:Arial;	font-size:12px;	/* font-weight:bold; */	padding:3px 10px;	text-decoration:none;	text-shadow:0px 1px 0px #1570cd;}.myButton:hover {	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #1e62d0), color-stop(1, #3d94f6));	background:-moz-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-webkit-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-o-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-ms-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:linear-gradient(to bottom, #1e62d0 5%, #3d94f6 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#1e62d0', endColorstr='#3d94f6',GradientType=0);	background-color:#1e62d0;}.myButton:active {	position:relative;	top:1px;}&lt;/style&gt;";
	template.print(css_str);

	//start table
	template.print("&lt;table&gt;");
    if (current.assignment_group.u_attach_kb_method == "Manual"){
        var v1 = current.assignment_group.u_attach_kb_1;
        var v2 = current.assignment_group.u_attach_kb_2;
        var v3 = current.assignment_group.u_attach_kb_3;

		//this func also writes additional articles if &lt; 3 are provided
        writeKb(v1, v2, v3);
    } else {
        //attach 3 kbs that match the search based on short desc
        writeKbMultiple(3);
    }
	template.print("&lt;/table&gt;");
	//end table

	/*
    //write the rest of the msg
    template.print("\n");
    template.print("\n");
    template.print('If the KB articles solved your inquiry, please click the link below to close your ticket.');

    //add link to widget that closes the incident

    template.print("\n");
    var widget_with_inc = "url_to_widget/?inc=" + current.sys_id;
    template.print('&lt;a href=' + widget_with_inc  + ' target="_blank"&gt;Click here to close your incident.&lt;/a&gt;');
	*/

})(current, template, email, email_action, event);

// Variables accessible from script:
// current: Current GlideRecord
// template: Handles printing to the email message
// email: EmailOutbound object (null when called from Client Template)
// email_action: GlideRecord for the email notification (null when called from Client Template)
// event: GlideRecord for the event that fired the notification (null when called from Client Template)


function writeKb(v1, v2, v3){
    //count of how many kb's we need to query
	var count = 0;

	//check if [1, 3] kb is provided
	if (!v1) count++;
	if (!v2) count++;
	if (!v3) count++;

	//dynamically write 3, if mode is manual but 0 kbs are provided
	if (count == 3) {
		writeKbMultiple(count);
	}
	else {
		writeKbMixed(count, v1, v2, v3);
	}
}


function writeKbMixed(count, v1, v2, v3){
	var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
	var widget_base = "sp?id=incident_close_link&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var kbase = '7c2d56f42bd89200e0b209d417da153e'; // IT - Public

	var query = "";
    query += 'kb_knowledge_base=' + kbase;
    query += '^IR_OR_QUERY=' + current.short_description;

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count);
    kbArt.addEncodedQuery(query);
    kbArt.addQuery('kb_knowledge_base', kbase);
    kbArt.addQuery('workflow_state','published');
    kbArt.query();

    //if kb is provided, write that one
	if (v1){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v1.sys_id + ' target="_blank"&gt;' + v1.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	}
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		}
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

	//if kb is provided, write that one
	if (v2){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v2.sys_id + ' target="_blank"&gt;' + v2.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	}
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		}
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

    //if kb is provided, write that one
	if (v3){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v3.sys_id + ' target="_blank"&gt;' + v3.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	}
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		}
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

}


function writeKbMultiple(count) {
    var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
    var widget_base = "sp?id=incident_close_link&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var kbase = '7c2d56f42bd89200e0b209d417da153e'; // IT - Public

    var query = "";
    query += 'kb_knowledge_base=' + kbase;
    query += '^IR_OR_QUERY=' + current.short_description;

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count);
    kbArt.addEncodedQuery(query);
    kbArt.addQuery('kb_knowledge_base', kbase);
    kbArt.addQuery('workflow_state', 'published');
    kbArt.query();

    //it's possible we don't get 3 articles back.
    //then just write as many as we get
    while (kbArt.next()) {
        //gs.log(kbArt.number + " " + kbArt.short_description);
        template.print("&lt;tr&gt;");
        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		//button
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
        template.print("&lt;/tr&gt;");
    }
}
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_email&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-24 16:16:20&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_id&gt;&lt;sys_mod_count&gt;69&lt;/sys_mod_count&gt;&lt;sys_name&gt;incident_include_relevant_kb&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_email_1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-damascus&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-20 18:22:24&lt;/sys_updated_on&gt;&lt;/sys_script_email&gt;&lt;/record_update&gt;</payload>
<payload_hash>-731803741</payload_hash>
<remote_update_set display_value="IET STRY0058349 Enhancement: KB Article in Incident email also triggers on group">e2bfcb124f3fd3400d952b8ca310c763</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>66bfcb124f3fd3400d952b8ca310c764</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641f7c01d00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table/>
<target_name>incident_include_relevant_kb</target_name>
<type>Email Script</type>
<update_domain>global</update_domain>
<update_guid>a0d36bf125b6538047958b79d0d26111</update_guid>
<update_guid_history>a0d36bf125b6538047958b79d0d26111:-731803741,1af0e37172b65380aadc4432690cfe8a:-82312715,eed06fb13db65380037a13ce53420461:-731803741,1bff9bb1c1b65380cdd741d401d67355:-1121188946,64fd87e1fc3e1380b50b91e01fce4528:-731803741,7a4932212afa1380e449d308e6e2d73c:-1029147077,8df52e2551ba1380305bd1bf7a32d8bb:1891044717,bfe52e253aba13807cbeb73166ddd379:-106479397,49c56e25a9ba1380529ad12d3f53f08a:1596226715,67a5aee141ba1380053fdb5f81f7072a:1752739899,37556225bfba138091abcbbfa2a68913:729397439,f814a6e122ba138010aa3376c28e6ed8:1371620317,5ba32ae1b6ba1380e00166a04942bef7:473462572,b28266a116ba138072046886103a74fa:-626877156,6f8122a1baba1380bce38d66e79e33e9:-102970522,97dc12e9c87a1380f9307ad55a84dbd9:776183103,a245f510083e97405db29c8a58715a57:-774461761,a15fd20602621b405ba2dcde41c81fd7:-718301875,20be56c2ee621b409574d180ced165be:1272403919,18ed1dafd7dad3009c06ba29d96ecf28:889957367,af7d95afacdad300f63cb9be97546207:-1083534923,984d15affcdad300a0b45d82c3ebcd23:-1174782924,97cc996f76dad30045aa497285476d2e:-1927758944,f93b19eb77dad300cb19a6260edc822e:-2140074465,4298156ba4dad3009f77094059d347f7:794175821,8b51952731dad300d1a82f5df68da175:-426053895,4c4f05a3eedad3007ee3610b4c94df5e:794175821,bd6305ebef9ad30085cdeeff6d36f129:-536487651,4ba1cd2bef9ad3001393edc890fb1ea5:2092245381,0b47e827a15ad3008658df05b6deff33:226830873,59e56827955ad3004d0427e3221b4c4b:-746666249,80e5e8276a5ad300319b0f5af3c879e2:1650496228,4165ace3755ad3001926723ec99368f8:282954009,8fb4e0279e5ad30036e81ffa1a1e5258:653214181,c31420e38a5ad30041c31da96c5f9f68:-1735407054,f192ac63505ad3000812b60fefea4cdb:1741323955,ed9198e7391ad300d99133818b271d23:2024030483,e4684f3eaf1693002019808e04d2c6f3:1393366783,08644bbab116930080271ee01e92f1e7:-339299198,afb3c3babf16930070d18ae6e8cc4e7a:1411950891,71a34b3a7f16930054f8924d5b96197c:129615693,00f0433a4316930064abfc8ebb5d9823:-144072004,0dcabe368a169300853ddef7d1db2fe6:1288834507,336a3a360c169300ec1f5a4937195df8:-161266019,f469feb26616930082b811c910811903:-708362339,9f187e72dc169300dfe3c70f986f77bd:-333097782,b6573efebdd2930095289652f56465c8:-864184942,93753efec4d29300b522b1be373b54c2:959388866,a7c47e7e37d2930059ceaa1e21cfe5ef:-554236393,5e9aa6f6f1d29300da8eb275501c6a29:-2058353522,c1496e369bd293000e6c5abeeaa50733:-1095736062,1c20ae7aa956df00bcf89b92e10e0ae5:-643951813,6e6f5e3e4d56df00a0c03e934a1a822f:-527518582,6c9edaba9896df006b5910bc745cfa3c:778447343,26e082b60256df00143fc38799e428ad:-1062469659,eb39b9b2ad56df006f79632251155dc8:2024427394,881f491552529b0033d6c29387d4bf0f:2032238305,0a5e011181529b000fdde17eef3def83:-1075160591,ea18415153529b0064eab1de491bc621:-6890014,bdf7c59d01129b001423e7aaea248aac:-1434059075,5ad5c59d60129b0047432bda3e95bef4:1253601649,bbb37455ac129b00faa8d17c179858cf:-1992214228,7232345545129b00fb65ce7a0a703fa1:496527116,9bbda051c2129b007e1a6d2985d78db5:1781045456,de4ae419f3de5b008b555d6c79a54fe3:-723601656,4203ac1d3ede5b006618d823ab617896:1908294079,5a495895b6de5b0044f5380ff50c7e5f:-1371753776,85f6d8d15dde5b0008c176d65da616d5:45003350,165604d9209e5b00d31ee8dab18f21fa:648340869,aa04c8d9f69e5b00afe4dd51aa150b8e:-667673171</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sysevent_email_action_8c0a15b86f1bf000091f52a03f3ee456</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_email_action"&gt;&lt;sysevent_email_action action="INSERT_OR_UPDATE"&gt;&lt;action_insert&gt;false&lt;/action_insert&gt;&lt;action_update&gt;true&lt;/action_update&gt;&lt;active&gt;true&lt;/active&gt;&lt;advanced_condition&gt;&lt;![CDATA[// check if group has changed
answer = !current.assignment_group.changes();]]&gt;&lt;/advanced_condition&gt;&lt;affected_field_on_event/&gt;&lt;category display_value="Incident" name="Incident"&gt;4d7f4b0713b103003527bd122244b096&lt;/category&gt;&lt;collection&gt;incident&lt;/collection&gt;&lt;condition table="incident"&gt;commentsVALCHANGES^u_emailed_fromISEMPTY^u_do_not_send_notification=false^EQ&lt;item endquery="false" field="comments" goto="false" newquery="false" operator="VALCHANGES" or="false" value=""/&gt;&lt;item endquery="false" field="u_emailed_from" goto="false" newquery="false" operator="ISEMPTY" or="false" value=""/&gt;&lt;item endquery="false" field="u_do_not_send_notification" goto="false" newquery="false" operator="=" or="false" value="false"/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/condition&gt;&lt;content_type&gt;multipart/mixed&lt;/content_type&gt;&lt;description&gt;Purpose: Sends notifications when comments added (see settings below for full conditions).&amp;#13;
&amp;#13;
Does not run if the assignment group changes: See "User: Incident commented, changed group" for that case.&amp;#13;
&amp;#13;
Does not run if 'Emailed from' field is filled: See "User: Incident commented Email" for that case.&lt;/description&gt;&lt;event_name&gt;incident.commented&lt;/event_name&gt;&lt;event_parm_1&gt;false&lt;/event_parm_1&gt;&lt;event_parm_2&gt;false&lt;/event_parm_2&gt;&lt;exclude_delegates&gt;false&lt;/exclude_delegates&gt;&lt;force_delivery&gt;false&lt;/force_delivery&gt;&lt;from/&gt;&lt;generation_type&gt;engine&lt;/generation_type&gt;&lt;importance/&gt;&lt;include_attachments&gt;true&lt;/include_attachments&gt;&lt;item&gt;event.parm1&lt;/item&gt;&lt;item_table/&gt;&lt;mandatory&gt;false&lt;/mandatory&gt;&lt;message/&gt;&lt;message_html/&gt;&lt;message_list/&gt;&lt;message_text/&gt;&lt;name&gt;User: Incident commented not email&lt;/name&gt;&lt;omit_watermark&gt;false&lt;/omit_watermark&gt;&lt;order&gt;100&lt;/order&gt;&lt;push_message_only&gt;false&lt;/push_message_only&gt;&lt;recipient_fields&gt;watch_list,caller_id,u_requested_for&lt;/recipient_fields&gt;&lt;recipient_groups/&gt;&lt;recipient_users/&gt;&lt;reply_to/&gt;&lt;send_self&gt;true&lt;/send_self&gt;&lt;sms_alternate/&gt;&lt;style/&gt;&lt;subject/&gt;&lt;subscribable&gt;false&lt;/subscribable&gt;&lt;sys_class_name&gt;sysevent_email_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;TPAdmin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2013-01-30 16:26:12&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_id&gt;8c0a15b86f1bf000091f52a03f3ee456&lt;/sys_id&gt;&lt;sys_mod_count&gt;17&lt;/sys_mod_count&gt;&lt;sys_name&gt;User: Incident commented not email&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package/&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_email_action_8c0a15b86f1bf000091f52a03f3ee456&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-bgerrity&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-19 23:15:47&lt;/sys_updated_on&gt;&lt;sys_version/&gt;&lt;template display_value="user.incident.commented"&gt;f17e0aed13fff6403527bd122244b00a&lt;/template&gt;&lt;type&gt;email&lt;/type&gt;&lt;weight&gt;20&lt;/weight&gt;&lt;/sysevent_email_action&gt;&lt;/record_update&gt;</payload>
<payload_hash>1627788446</payload_hash>
<remote_update_set display_value="IET STRY0058349 Enhancement: KB Article in Incident email also triggers on group">e2bfcb124f3fd3400d952b8ca310c763</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>6abfcb124f3fd3400d952b8ca310c763</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641f7c01d00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>incident</table>
<target_name>User: Incident commented not email</target_name>
<type>Notification</type>
<update_domain>global</update_domain>
<update_guid>e86d57e9233e13803b56583736271e6d</update_guid>
<update_guid_history>e86d57e9233e13803b56583736271e6d:1627788446,d2e9db29353e1380a549009aa79ecb50:1643331684,b2e5d729213e138046b694c46fe6d635:1294975763,a612db65883e1380cda844de21edc2cb:124276956,29021765913e1380099202c91cbd1bd9:-1938075778,757d4fa1283e138062775752577efeb9:1579187316,b14b43a11d3e13800a1b9b2a22bedef0:-2013095494,543b4f61533e1380d1e81a85784b46ef:-2036561702,9d4a8361c93e1380f85df756b5fdf6a6:-2001472067,1ef88721663e1380fdedfd984159c35f:1167387536,b4b84b211c3e138003dc1daf99a0c735:1016417427,904884637:904884637,1494094624:1494094624,446277735:446277735,910666536:910666536,446277735:446277735,910666536:910666536,2144367955:2144367955,1035819279:1035819279,2144367955:2144367955,-208747629:-208747629</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sysevent_email_template_f17e0aed13fff6403527bd122244b00a</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sysevent_email_template"&gt;&lt;sysevent_email_template action="INSERT_OR_UPDATE"&gt;&lt;collection&gt;incident&lt;/collection&gt;&lt;email_layout/&gt;&lt;message&gt;&lt;![CDATA[Thank you for contacting the UC Davis Service Desk. We have received your request ${number} and are working to resolve your issue as quickly as possible. We will contact you via email when we have come to a resolution.

Subject: ${short_description}

Sincerely,
The UC Davis Service Desk]]&gt;&lt;/message&gt;&lt;message_html&gt;&lt;![CDATA[&lt;div&gt;${mail_script:incident_personalize_salutation}&lt;/div&gt;
&lt;div&gt;This is a notification regarding your request titled: ${short_description}&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Please see the comments from your service analyst below. &amp;nbsp;To email us about this service request, please reply to this message, and leave the subject line intact.&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;If you are a UC Davis affiliate with a login ID, you can check the status of your ticket at the&amp;nbsp;&lt;a href="/ess/incident_status.do"&gt;Service Hub&lt;/a&gt;.&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;Sincerely,&lt;/div&gt;
&lt;div&gt;${mail_script:incident_email_from_and_sig}&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;${comments}&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;]]&gt;&lt;/message_html&gt;&lt;message_list/&gt;&lt;message_text/&gt;&lt;name&gt;user.incident.commented&lt;/name&gt;&lt;sms_alternate/&gt;&lt;subject&gt;${number} "${short_description}" - Notification&lt;/subject&gt;&lt;sys_class_name&gt;sysevent_email_template&lt;/sys_class_name&gt;&lt;sys_created_by&gt;ktjones&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2017-07-06 18:11:29&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;f17e0aed13fff6403527bd122244b00a&lt;/sys_id&gt;&lt;sys_mod_count&gt;15&lt;/sys_mod_count&gt;&lt;sys_name&gt;user.incident.commented&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_email_template_f17e0aed13fff6403527bd122244b00a&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-bgerrity&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-19 22:40:03&lt;/sys_updated_on&gt;&lt;sys_version&gt;2&lt;/sys_version&gt;&lt;/sysevent_email_template&gt;&lt;/record_update&gt;</payload>
<payload_hash>685164487</payload_hash>
<remote_update_set display_value="IET STRY0058349 Enhancement: KB Article in Incident email also triggers on group">e2bfcb124f3fd3400d952b8ca310c763</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>a2bfcb124f3fd3400d952b8ca310c764</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641f7c01d00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>user.incident.commented</target_name>
<type>Email Template</type>
<update_domain>global</update_domain>
<update_guid>f0359be5a23e13803d093467875c98fc</update_guid>
<update_guid_history>f0359be5a23e13803d093467875c98fc:685164487,0001d7655d3e1380bc39584dac2f3689:-844163535,922d43e1813e138067d219665970764a:-1636088776,86006e21f8ba1380f10e721a57865eed:-201407171,02cf5a219bba13802cf30b764f70dab9:-1717893088,913f1221c5ba1380b869de1655a8849c:-1636088776,0e5d52ed5b7a1380ad4efa4c8515887b:944515291,43aef0bddfaf4b409a3e361ab9bcc062:254029148,d6dcf8793baf4b40ad5e5a01a6c57950:2006317017,384830066:384830066,-912201812:-912201812</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sysevent_email_action_0a34cf2d13fa13803527bd122244b0df</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_email_action"&gt;&lt;sysevent_email_action action="INSERT_OR_UPDATE"&gt;&lt;action_insert&gt;false&lt;/action_insert&gt;&lt;action_update&gt;true&lt;/action_update&gt;&lt;active&gt;true&lt;/active&gt;&lt;advanced_condition&gt;&lt;![CDATA[// check if group has changed
answer = current.assignment_group.changes();]]&gt;&lt;/advanced_condition&gt;&lt;affected_field_on_event/&gt;&lt;category display_value="Incident" name="Incident"&gt;4d7f4b0713b103003527bd122244b096&lt;/category&gt;&lt;collection&gt;incident&lt;/collection&gt;&lt;condition table="incident"&gt;commentsVALCHANGES^u_do_not_send_notification=false^EQ&lt;item endquery="false" field="comments" goto="false" newquery="false" operator="VALCHANGES" or="false" value=""/&gt;&lt;item endquery="false" field="u_do_not_send_notification" goto="false" newquery="false" operator="=" or="false" value="false"/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/condition&gt;&lt;content_type&gt;multipart/mixed&lt;/content_type&gt;&lt;description&gt;Purpose: Sends notifications when comments added if assignment group is changed (see settings below for full conditions).&amp;#13;
&amp;#13;
Does not run if the assignment group not changed: See and "User: Incident commented Email" and "User: Incident commented not email" for those cases.&amp;#13;
&amp;#13;
Note: Will notify both the 'Emailed from' address (if filled) and the Caller's primary email.&lt;/description&gt;&lt;event_name&gt;approval.cancelled&lt;/event_name&gt;&lt;event_parm_1&gt;false&lt;/event_parm_1&gt;&lt;event_parm_2&gt;false&lt;/event_parm_2&gt;&lt;exclude_delegates&gt;false&lt;/exclude_delegates&gt;&lt;force_delivery&gt;false&lt;/force_delivery&gt;&lt;from/&gt;&lt;generation_type&gt;engine&lt;/generation_type&gt;&lt;importance/&gt;&lt;include_attachments&gt;true&lt;/include_attachments&gt;&lt;item&gt;event.parm1&lt;/item&gt;&lt;item_table/&gt;&lt;mandatory&gt;false&lt;/mandatory&gt;&lt;message/&gt;&lt;message_html/&gt;&lt;message_list/&gt;&lt;message_text/&gt;&lt;name&gt;User: Incident commented, changed group&lt;/name&gt;&lt;omit_watermark&gt;false&lt;/omit_watermark&gt;&lt;order&gt;100&lt;/order&gt;&lt;push_message_only&gt;false&lt;/push_message_only&gt;&lt;recipient_fields&gt;watch_list,caller_id,u_requested_for,u_emailed_from&lt;/recipient_fields&gt;&lt;recipient_groups/&gt;&lt;recipient_users/&gt;&lt;reply_to/&gt;&lt;send_self&gt;true&lt;/send_self&gt;&lt;sms_alternate/&gt;&lt;style/&gt;&lt;subject/&gt;&lt;subscribable&gt;false&lt;/subscribable&gt;&lt;sys_class_name&gt;sysevent_email_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-bgerrity&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-06-19 21:27:45&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_id&gt;0a34cf2d13fa13803527bd122244b0df&lt;/sys_id&gt;&lt;sys_mod_count&gt;11&lt;/sys_mod_count&gt;&lt;sys_name&gt;User: Incident commented, changed group&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_email_action_0a34cf2d13fa13803527bd122244b0df&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-bgerrity&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-19 23:22:28&lt;/sys_updated_on&gt;&lt;sys_version&gt;2&lt;/sys_version&gt;&lt;template display_value="user.incident.commented.change.group"&gt;6b8c0fa1133e13803527bd122244b0f6&lt;/template&gt;&lt;type&gt;email&lt;/type&gt;&lt;weight&gt;20&lt;/weight&gt;&lt;/sysevent_email_action&gt;&lt;/record_update&gt;</payload>
<payload_hash>-1991659930</payload_hash>
<remote_update_set display_value="IET STRY0058349 Enhancement: KB Article in Incident email also triggers on group">e2bfcb124f3fd3400d952b8ca310c763</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>a6bfcb124f3fd3400d952b8ca310c763</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641f7c01d00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table>incident</table>
<target_name>User: Incident commented, changed group</target_name>
<type>Notification</type>
<update_domain>global</update_domain>
<update_guid>12ee5f2d843e1380a4d1be97dfe99460</update_guid>
<update_guid_history>12ee5f2d843e1380a4d1be97dfe99460:-1991659930,4b9e136d093e13806b158cdab18b66b2:53384953,86edd72d563e13803a5b6fdbea73ab5a:1386650815,ba1a9fa9be3e1380153e2aa4f7bee210:-382679718,281a1fa9213e1380c41eefed8cf0f265:1144194108,33e51b29703e13804536bdc3202abc21:1720746726,726457e5ba3e1380a806f620b03306c3:1184136258,26545be5683e1380b5b99dd69c1fcde0:-371511859,664d43e1543e1380e9e6ad9a7e736366:1989738066,6e4c43a1403e1380435ec291b2dea13a:-772274392,31e4c76debfa1380e494071a41640d3f:1571240435,71a4036d3ffa1380c8192df10dad2327:-922476822</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_ui_view_1353cc0a13f653803527bd122244b08c</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_view"><sys_ui_view action="INSERT_OR_UPDATE"><group/><hidden>false</hidden><name>sys_popup,RPT4913cc4a13f653803527bd122244b0aa</name><roles/><sys_class_name>sys_ui_view</sys_class_name><sys_created_by>admin-eduque</sys_created_by><sys_created_on>2018-06-20 20:40:13</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>1353cc0a13f653803527bd122244b08c</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Sys_popup,rpt4913cc4a13f653803527bd122244b0aa</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_view_1353cc0a13f653803527bd122244b08c</sys_update_name><sys_updated_by>admin-eduque</sys_updated_by><sys_updated_on>2018-06-20 20:40:13</sys_updated_on><title>Sys_popup,rpt4913cc4a13f653803527bd122244b0aa</title><user/></sys_ui_view></record_update>]]></payload>
<payload_hash>-1500033147</payload_hash>
<remote_update_set display_value="IET STRY0058349 Enhancement: KB Article in Incident email also triggers on group">e2bfcb124f3fd3400d952b8ca310c763</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>eabfcb124f3fd3400d952b8ca310c764</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641f7c01d00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>live_message_tag</table>
<target_name>Sys_popup,rpt4913cc4a13f653803527bd122244b0aa</target_name>
<type>UI View</type>
<update_domain>global</update_domain>
<update_guid>9353cc0acbf65380c98c2cfe5b829c8d</update_guid>
<update_guid_history>9353cc0acbf65380c98c2cfe5b829c8d:-1500033147</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sysevent_email_template_6b8c0fa1133e13803527bd122244b0f6</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sysevent_email_template"&gt;&lt;sysevent_email_template action="INSERT_OR_UPDATE"&gt;&lt;collection&gt;incident&lt;/collection&gt;&lt;email_layout/&gt;&lt;message/&gt;&lt;message_html&gt;&lt;![CDATA[&lt;div&gt;${mail_script:incident_personalize_salutation}&lt;/div&gt;
&lt;div&gt;This is a notification regarding your request titled: ${short_description}&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;Please see the comments from your service analyst below. &amp;nbsp;To email us about this service request, please reply to this message, and leave the subject line intact.&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;If you are a UC Davis affiliate with a login ID, you can check the status of your ticket at the&amp;nbsp;&lt;a href="/ess/incident_status.do"&gt;Service Hub&lt;/a&gt;.&lt;/div&gt;
&lt;div&gt;${mail_script:incident_include_relevant_kb}&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;Sincerely,&lt;/div&gt;
&lt;div&gt;${mail_script:incident_email_from_and_sig}&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;${comments}&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;]]&gt;&lt;/message_html&gt;&lt;message_list/&gt;&lt;message_text/&gt;&lt;name&gt;user.incident.commented.change.group&lt;/name&gt;&lt;sms_alternate/&gt;&lt;subject&gt;${number} "${short_description}" - Notification&lt;/subject&gt;&lt;sys_class_name&gt;sysevent_email_template&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-bgerrity&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-06-19 22:03:07&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;6b8c0fa1133e13803527bd122244b0f6&lt;/sys_id&gt;&lt;sys_mod_count&gt;3&lt;/sys_mod_count&gt;&lt;sys_name&gt;user.incident.commented.change.group&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_email_template_6b8c0fa1133e13803527bd122244b0f6&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-bgerrity&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-19 22:40:09&lt;/sys_updated_on&gt;&lt;sys_version&gt;2&lt;/sys_version&gt;&lt;/sysevent_email_template&gt;&lt;/record_update&gt;</payload>
<payload_hash>1261802816</payload_hash>
<remote_update_set display_value="IET STRY0058349 Enhancement: KB Article in Incident email also triggers on group">e2bfcb124f3fd3400d952b8ca310c763</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:22</sys_created_on>
<sys_id>eebfcb124f3fd3400d952b8ca310c763</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>1641f7c01d00000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:22</sys_updated_on>
<table>incident</table>
<target_name>user.incident.commented.change.group</target_name>
<type>Email Template</type>
<update_domain>global</update_domain>
<update_guid>1a35d329db3e1380af02a18253403688</update_guid>
<update_guid_history>1a35d329db3e1380af02a18253403688:1261802816,59015765d93e1380670598b9b299df53:1244112861,f72d43e1eb3e138080fdb2b4561d4ca1:1261802816,88cc07a1963e13808cc1c600bd423f31:1087402316</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>retrieved</category>
<comments/>
<name>sys_script_email_1dd304d9139e5b00d26f5e7f3244b057</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_email"&gt;&lt;sys_script_email action="INSERT_OR_UPDATE"&gt;&lt;name&gt;incident_include_relevant_kb&lt;/name&gt;&lt;new_lines_to_html&gt;true&lt;/new_lines_to_html&gt;&lt;script&gt;&lt;![CDATA[//insert relevant kb articles for this new incident
(function runMailScript(current, template, email, email_action, event) {
    //check if group has attach_kb enabled
    if (!current.assignment_group.u_attach_kb_enable){
        return;
    }

    //attach_kb is enabled for the group, so write the following
    template.print("\n");
    template.print('Meanwhile, please see the following Knowledge Base articles to see if they might assist you with your inquiry:');
    template.print("\n");

    //does group have manual kb attachment tho?
    //attaching the kb articles is different if group has manual settings.
	//start table

	//css for table and button
// 	var css_str = "&lt;style&gt;table {    font-family: arial, sans-serif;    border-collapse: collapse;    width: 100%;}tr {border-bottom: 1px solid #ccc;}td, th {    text-align: left;    padding: 8px;}.myButton {	-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;	-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;	box-shadow:inset 0px 1px 0px 0px #97c4fe;	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #3d94f6), color-stop(1, #1e62d0));	background:-moz-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-webkit-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-o-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:-ms-linear-gradient(top, #3d94f6 5%, #1e62d0 100%);	background:linear-gradient(to bottom, #3d94f6 5%, #1e62d0 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#3d94f6', endColorstr='#1e62d0',GradientType=0);	background-color:#3d94f6;	-moz-border-radius:6px;	-webkit-border-radius:6px;	border-radius:6px;	border:1px solid #337fed;	display:inline-block;	cursor:pointer;	color:#ffffff;	font-family:Arial;	font-size:15px;	font-weight:bold;	padding:6px 24px;	text-decoration:none;	text-shadow:0px 1px 0px #1570cd;}.myButton:hover {	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #1e62d0), color-stop(1, #3d94f6));	background:-moz-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-webkit-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-o-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-ms-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:linear-gradient(to bottom, #1e62d0 5%, #3d94f6 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#1e62d0', endColorstr='#3d94f6',GradientType=0);	background-color:#1e62d0;}.myButton:active {	position:relative;	top:1px;}&lt;/style&gt;";
	var css_str = "&lt;style&gt;table {    font-family: arial, sans-serif;    border-collapse: collapse;    width: 100%;}tr {border-bottom: 1px solid #ccc;}td, th {    text-align: left;    padding: 8px;}.myButton {		-moz-box-shadow:inset 0px 1px 0px 0px #97c4fe;	-webkit-box-shadow:inset 0px 1px 0px 0px #97c4fe;	background-color:#3d94f6;	-moz-border-radius:6px;	-webkit-border-radius:6px;	border-radius:6px;	border:1px solid #337fed;	display:inline-block;	cursor:pointer;	color:#ffffff;	font-family:Arial;	font-size:12px;	/* font-weight:bold; */	padding:3px 10px;	text-decoration:none;	text-shadow:0px 1px 0px #1570cd;}.myButton:hover {	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #1e62d0), color-stop(1, #3d94f6));	background:-moz-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-webkit-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-o-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:-ms-linear-gradient(top, #1e62d0 5%, #3d94f6 100%);	background:linear-gradient(to bottom, #1e62d0 5%, #3d94f6 100%);	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#1e62d0', endColorstr='#3d94f6',GradientType=0);	background-color:#1e62d0;}.myButton:active {	position:relative;	top:1px;}&lt;/style&gt;";
	template.print(css_str);

	//start table
	template.print("&lt;table&gt;");
    if (current.assignment_group.u_attach_kb_method == "Manual"){
        var v1 = current.assignment_group.u_attach_kb_1;
        var v2 = current.assignment_group.u_attach_kb_2;
        var v3 = current.assignment_group.u_attach_kb_3;

		//this func also writes additional articles if &lt; 3 are provided
        writeKb(v1, v2, v3);
    } else {
        //attach 3 kbs that match the search based on short desc
        writeKbMultiple(3);
    }
	template.print("&lt;/table&gt;");
	//end table

	/*
    //write the rest of the msg
    template.print("\n");
    template.print("\n");
    template.print('If the KB articles solved your inquiry, please click the link below to close your ticket.');

    //add link to widget that closes the incident

    template.print("\n");
    var widget_with_inc = "url_to_widget/?inc=" + current.sys_id;
    template.print('&lt;a href=' + widget_with_inc  + ' target="_blank"&gt;Click here to close your incident.&lt;/a&gt;');
	*/

})(current, template, email, email_action, event);

// Variables accessible from script:
// current: Current GlideRecord
// template: Handles printing to the email message
// email: EmailOutbound object (null when called from Client Template)
// email_action: GlideRecord for the email notification (null when called from Client Template)
// event: GlideRecord for the event that fired the notification (null when called from Client Template)


function writeKb(v1, v2, v3){
    //count of how many kb's we need to query
	var count = 0;

	//check if [1, 3] kb is provided
	if (!v1) count++;
	if (!v2) count++;
	if (!v3) count++;

	//dynamically write 3, if mode is manual but 0 kbs are provided
	if (count == 3) {
		writeKbMultiple(count);
	}
	else {
		writeKbMixed(count, v1, v2, v3);
	}
}


function writeKbMixed(count, v1, v2, v3){
	var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
	var widget_base = "sp?id=incident_close_link&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var kbase = '7c2d56f42bd89200e0b209d417da153e'; // IT - Public

	var query = "";
    query += 'kb_knowledge_base=' + kbase;
    query += '^IR_OR_QUERY=' + current.short_description;

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count);
    kbArt.addEncodedQuery(query);
    kbArt.addQuery('kb_knowledge_base', kbase);
    kbArt.addQuery('workflow_state','published');
    kbArt.query();

    //if kb is provided, write that one
	if (v1){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v1.sys_id + ' target="_blank"&gt;' + v1.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	}
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		}
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

	//if kb is provided, write that one
	if (v2){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v2.sys_id + ' target="_blank"&gt;' + v2.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	}
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		}
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

    //if kb is provided, write that one
	if (v3){
		template.print("&lt;tr&gt;");
		//kb link
		template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + v3.sys_id + ' target="_blank"&gt;' + v3.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
		//button
		var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
		template.print("&lt;/tr&gt;");
	}
	//else, write it from the query
	else {
		//if query has a kb
		if (kbArt.next()){
			template.print("&lt;tr&gt;");
			//kb link
			template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description +'&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
			var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
			template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
			template.print("&lt;/tr&gt;");
		}
		//else query didnt have a kb
		//dont do anything kek
		else {
		}
	}

}


function writeKbMultiple(count) {
    var base_url = "servicehub/?id=ucd_kb_article&amp;sys_id=";
    var widget_base = "sp?id=incident_close_link&amp;inc="; //need 15&amp;kb=20

    // Set up basic query for IT - Public Knowledge base
    var kbase = '7c2d56f42bd89200e0b209d417da153e'; // IT - Public

    var query = "";
    query += 'kb_knowledge_base=' + kbase;
    query += '^IR_OR_QUERY=' + current.short_description;

    var kbArt = new GlideRecord('kb_knowledge');
    kbArt.setLimit(count);
    kbArt.addEncodedQuery(query);
    kbArt.addQuery('kb_knowledge_base', kbase);
    kbArt.addQuery('workflow_state', 'published');
    kbArt.query();

    //it's possible we don't get 3 articles back.
    //then just write as many as we get
    while (kbArt.next()) {
        //gs.log(kbArt.number + " " + kbArt.short_description);
        template.print("&lt;tr&gt;");
        //kb link
        template.print('&lt;td&gt;&lt;b&gt;&lt;a href=' + base_url + kbArt.sys_id + ' target="_blank"&gt;' + kbArt.short_description + '&lt;/a&gt;&lt;/b&gt;&lt;td&gt;');
        var widget_url = widget_base + current.sys_id + "&amp;kb=" + kbArt.sys_id;
		//button
        template.print('&lt;td&gt;&lt;a href=' + widget_url + ' class="myButton" target="_blank"&gt;Close my ticket&lt;/a&gt;&lt;/td&gt;');
        template.print("&lt;/tr&gt;");
    }
}
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_email&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin-nexisn4&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-05-24 16:16:20&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_id&gt;&lt;sys_mod_count&gt;53&lt;/sys_mod_count&gt;&lt;sys_name&gt;incident_include_relevant_kb&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_email_1dd304d9139e5b00d26f5e7f3244b057&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin-eduque&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-06-15 18:28:35&lt;/sys_updated_on&gt;&lt;/sys_script_email&gt;&lt;/record_update&gt;</payload>
<payload_hash>-774461761</payload_hash>
<remote_update_set display_value="IET STRY0051388 Enhancement - Incident Emails: Pull in KB articles into notifi 3">e6bfcb124f3fd3400d952b8ca310c75a</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>admin-eduque</sys_created_by>
<sys_created_on>2018-08-10 23:14:21</sys_created_on>
<sys_id>aabfcb124f3fd3400d952b8ca310c75a</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_recorded_at>16404b618400000000</sys_recorded_at>
<sys_updated_by>admin-eduque</sys_updated_by>
<sys_updated_on>2018-08-10 23:14:21</sys_updated_on>
<table/>
<target_name>incident_include_relevant_kb</target_name>
<type>Email Script</type>
<update_domain>global</update_domain>
<update_guid>a245f510083e97405db29c8a58715a57</update_guid>
<update_guid_history>a245f510083e97405db29c8a58715a57:-774461761,a15fd20602621b405ba2dcde41c81fd7:-718301875,20be56c2ee621b409574d180ced165be:1272403919,18ed1dafd7dad3009c06ba29d96ecf28:889957367,af7d95afacdad300f63cb9be97546207:-1083534923,984d15affcdad300a0b45d82c3ebcd23:-1174782924,97cc996f76dad30045aa497285476d2e:-1927758944,f93b19eb77dad300cb19a6260edc822e:-2140074465,4298156ba4dad3009f77094059d347f7:794175821,8b51952731dad300d1a82f5df68da175:-426053895,4c4f05a3eedad3007ee3610b4c94df5e:794175821,bd6305ebef9ad30085cdeeff6d36f129:-536487651,4ba1cd2bef9ad3001393edc890fb1ea5:2092245381,0b47e827a15ad3008658df05b6deff33:226830873,59e56827955ad3004d0427e3221b4c4b:-746666249,80e5e8276a5ad300319b0f5af3c879e2:1650496228,4165ace3755ad3001926723ec99368f8:282954009,8fb4e0279e5ad30036e81ffa1a1e5258:653214181,c31420e38a5ad30041c31da96c5f9f68:-1735407054,f192ac63505ad3000812b60fefea4cdb:1741323955,ed9198e7391ad300d99133818b271d23:2024030483,e4684f3eaf1693002019808e04d2c6f3:1393366783,08644bbab116930080271ee01e92f1e7:-339299198,afb3c3babf16930070d18ae6e8cc4e7a:1411950891,71a34b3a7f16930054f8924d5b96197c:129615693,00f0433a4316930064abfc8ebb5d9823:-144072004,0dcabe368a169300853ddef7d1db2fe6:1288834507,336a3a360c169300ec1f5a4937195df8:-161266019,f469feb26616930082b811c910811903:-708362339,9f187e72dc169300dfe3c70f986f77bd:-333097782,b6573efebdd2930095289652f56465c8:-864184942,93753efec4d29300b522b1be373b54c2:959388866,a7c47e7e37d2930059ceaa1e21cfe5ef:-554236393,5e9aa6f6f1d29300da8eb275501c6a29:-2058353522,c1496e369bd293000e6c5abeeaa50733:-1095736062,1c20ae7aa956df00bcf89b92e10e0ae5:-643951813,6e6f5e3e4d56df00a0c03e934a1a822f:-527518582,6c9edaba9896df006b5910bc745cfa3c:778447343,26e082b60256df00143fc38799e428ad:-1062469659,eb39b9b2ad56df006f79632251155dc8:2024427394,881f491552529b0033d6c29387d4bf0f:2032238305,0a5e011181529b000fdde17eef3def83:-1075160591,ea18415153529b0064eab1de491bc621:-6890014,bdf7c59d01129b001423e7aaea248aac:-1434059075,5ad5c59d60129b0047432bda3e95bef4:1253601649,bbb37455ac129b00faa8d17c179858cf:-1992214228,7232345545129b00fb65ce7a0a703fa1:496527116,9bbda051c2129b007e1a6d2985d78db5:1781045456,de4ae419f3de5b008b555d6c79a54fe3:-723601656,4203ac1d3ede5b006618d823ab617896:1908294079,5a495895b6de5b0044f5380ff50c7e5f:-1371753776,85f6d8d15dde5b0008c176d65da616d5:45003350,165604d9209e5b00d31ee8dab18f21fa:648340869,aa04c8d9f69e5b00afe4dd51aa150b8e:-667673171</update_guid_history>
<update_set display_value=""/>
<view/>
</sys_update_xml>
</unload>
